(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{116:function(e,t,a){e.exports=a.p+"static/media/logo.1584bb37.svg"},148:function(e){e.exports={name:"nebula",version:"0.1.4",private:!0,homepage:".",dependencies:{"@erebos/api-pss":"0.5.3","@erebos/swarm-browser":"0.5.3","@mainframe/rpc-stream":"0.3.0","@material-ui/core":"4.2.0","@material-ui/icons":"4.2.1","@material-ui/styles":"4.2.0","connected-react-router":"6.5.2","file-saver":"2.0.0","hash-sum":"1.0.2",jsonpack:"1.1.5","lz-string":"1.4.4",prettysize:"2.0.0","prop-types":"15.6.2",react:"16.8.6","react-blockies":"1.4.0","react-copy-to-clipboard":"5.0.1","react-dom":"16.8.6","react-helmet-async":"0.2.0","react-hot-loader":"4.6.3","react-jobs":"1.0.1","react-redux":"7.1.0","react-router":"5.0.1","react-scripts":"2.1.8","react-scroll":"1.7.10",redux:"4.0.4","redux-thunk":"2.3.0",rxjs:"6.4.0"},devDependencies:{eslint:"5.12.0","eslint-plugin-react-hooks":"1.5.1",hasky:"3.0.2","release-it":"10.3.1"},scripts:{start:"react-scripts start",build:"react-scripts build",test:"react-scripts test",eject:"react-scripts eject",lint:"eslint --ext .jsx,.js --max-warnings 0 src",release:"release-it --no-npm.publish"},browserslist:[">0.2%","not dead","not ie <= 11","not op_mini all"],husky:{hooks:{"pre-commit":"npm run lint"}}}},161:function(e,t){},178:function(e,t,a){"use strict";a.d(t,"run",function(){return s});var n=a(24),r=a(179),c=(a(161),Object(n.a)({},r.a));function s(e){window.addEventListener("message",function(t){return function(e,t){if(t||t.type){if(c[t.type])return c[t.type](e,t);console.error("Nebula::Handler not found")}else console.error("Nebula::Message is invalid")}(e,t.data)},!1),console.log("Nebula::APIs started")}},179:function(e,t,a){"use strict";a.d(t,"a",function(){return s});var n=a(38),r=a(34),c=a(30);var s=Object(n.a)({},"@NEBULA::CHAT_OPEN",function(e,t){var a=t.publicKey,n=e.dispatch,s=(0,e.getState)().chats.find(function(e){return e.key===a});n(s?Object(r.d)("/messenger/chat/".concat(s.key)):Object(c.j)(a))})},199:function(e,t,a){e.exports=a(263)},214:function(e,t,a){},261:function(e,t,a){},263:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(20),s=a.n(c),i=a(180),o=a(103),l=a.n(o),u=a(11),p=a(41),d=(a(214),a(7)),m=a(163),f=a(57),b=a(156),h=a(6),g=a.n(h),v=a(15),y=a(88),E=a(30),O=a(35),j="ERROR_CATCHED",k="ERROR_DISMISS";function x(e){return function(){var t=Object(v.a)(g.a.mark(function t(a){return g.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:a({type:j,error:e});case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}var w="ACCOUNT_REQUEST",C="ACCOUNT_RECEIVE",N="ACCOUNT_MUTATE";function T(e){return function(){var t=Object(v.a)(g.a.mark(function t(a){return g.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:a({type:N,account:{username:e}});case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}var S="APP_CONNECTING",A="APP_CONNECTED",z="APP_DISCONNECTED";var _={isStarted:!1,isConnected:!1,raw:""};function K(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_;switch((arguments.length>1?arguments[1]:void 0).type){case A:return Object.assign({},e,{isStarted:!0,isConnected:!0});case z:return Object.assign({},e,{isStarted:!0,isConnected:!1});default:return e}}var R=a(24),P={isLoading:!1,publicKey:"",overlayAddress:"",username:""};function B(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:P,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case w:return Object.assign({},e,{isLoading:!0});case C:return Object.assign({},e,Object(R.a)({isLoading:!1},t.account));case N:return Object.assign({},e,Object(R.a)({},t.account));default:return e}}var I={pss:"ws://127.0.0.1:8546",bzz:"http://127.0.0.1:8500",revealAddress:4},W="SETTINGS_MUTATE";var D={bzz:"",pss:"",revealAddress:0,size:0,mode:"full",home:"/"};function L(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:D,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case W:return Object.assign({},e,Object(R.a)({},t.settings));default:return e}}var F={};function M(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:F,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case E.a:case E.f:case E.e:case E.d:case E.b:case E.c:return Object.assign({},e,Object(R.a)({},t.contacts));default:return e}}var U=a(74),H=a(36),q=a.n(H),V=[];function G(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:V,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case O.a:return Object.assign([],e,Object(U.a)(t.chats));case O.b:return[].concat(Object(U.a)(e),[t.chat]);case O.d:case O.c:return e.map(function(e){return e.key!==t.key?e:(e.messages[q()(t.message)]=t.message,Object(R.a)({},e))});default:return e}}var J=[];function Q(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:J,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case O.e:case E.g:return[].concat(Object(U.a)(e),[t.sub]);default:return e}}var X=[];function Z(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:X,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case j:return[].concat(Object(U.a)(e),[t.error]);case k:return e.filter(function(e){return e!==t.error});default:return e}}var $=function(e){return Object(d.c)({router:Object(p.b)(e),app:K,account:B,settings:L,contacts:M,chats:G,subscriptions:Q,errors:Z})},Y=a(182),ee=a(12),te=a(14),ae=a(146),ne=a.n(ae),re=a(147),ce=a.n(re),se=function(){function e(t){Object(ee.a)(this,e),this.key=t,this.trackFields=["account.username","settings.pss","settings.bzz","settings.revealAddress","contacts","chats"],this.excludeActionTypes=["ACCOUNT_REQUEST","ACCOUNT_RECEIVE","CONTACTS_RESTORE","CONTACT_SUBSCRIBE","CHATS_RESTORE","CHAT_SUBSCRIBE"]}return Object(te.a)(e,[{key:"middleware",value:function(){var e=this,t=function(e,t){for(var a=t.split("."),n=e,r=0;r<a.length;r++){var c=a[r];if(!Object.hasOwnProperty.call(n,c))return;n=n[c]}return n},a=function(a){var n=a.settings,r=n.pss,c=n.bzz,s=n.revealAddress,i=Object(R.a)({},e.unpack(a.app.raw),{pss:r,bzz:c,revealAddress:s}),o=t(a,"account.publicKey");if(o){var l=t(a,"account.username");i[o]={username:l,contacts:a.contacts,chats:a.chats}}var u=ne.a.pack(i),p=ce.a.compress(u);localStorage.setItem(e.key,p)};return function(n){return function(r){return function(){var c=Object(v.a)(g.a.mark(function c(s){var i,o;return g.a.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return i=n.getState(),c.next=3,r(s);case 3:if(s.type&&!e.excludeActionTypes.includes(s.type)){c.next=5;break}return c.abrupt("return");case 5:o=n.getState(),e.trackFields.some(function(e){return t(i,e)!==t(o,e)})&&a(o);case 8:case"end":return c.stop()}},c)}));return function(e){return c.apply(this,arguments)}}()}}}},{key:"deriveInitialState",value:function(e){var t=localStorage.getItem(this.key),a=this.unpack(t),n=e.app,r=e.settings,c=Object(Y.a)(e,["app","settings"]);return Object(R.a)({app:Object(R.a)({},n,{raw:t},a),settings:Object(R.a)({},r,{pss:a.pss||I.pss,bzz:a.bzz||I.bzz,revealAddress:void 0===a.revealAddress?I.revealAddress:a.revealAddress,size:(t||"").length})},c)}},{key:"unpack",value:function(e){var t=ce.a.decompress(e);return t?ne.a.unpack(t):{}}}]),e}(),ie=a(93),oe=a(149),le=a(18),ue=a(16),pe=a(17),de=a(27),me=a(334),fe=a(54),be=a(328),he=a(332),ge=a(295),ve=a(296),ye=function(e){function t(e){var a,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3,r=arguments.length>2?arguments[2]:void 0,c=arguments.length>3?arguments[3]:void 0;return Object(ee.a)(this,t),(a=Object(le.a)(this,Object(ue.a)(t).call(this))).url=e,a.reconnectInterval=n,a.resultSelector=r,a.serializer=c,a.defaultResultSelector=function(e){return JSON.parse(e.data)},a.defaultSerializer=function(e){return JSON.stringify(e)},a.connectionStatus=new de.a(function(e){a.connectionObserver=e}).pipe(Object(he.a)()).pipe(Object(ge.a)()),r||(a.resultSelector=a.defaultResultSelector),a.serializer||(a.serializer=a.defaultSerializer),a.wsSubjectConfig={url:e,closeObserver:{next:function(e){a.socket=null,a.connectionObserver.next(!1)}},openObserver:{next:function(e){a.connectionObserver.next(!0)}}},a.connect(),a.connectionStatus.subscribe(function(e){a.reconnectionObservable||"boolean"!=typeof e||e||a.reconnect()}),a}return Object(pe.a)(t,e),Object(te.a)(t,[{key:"connect",value:function(){var e=this;this.socket=new be.a(this.wsSubjectConfig),this.socket.subscribe(function(t){e.next(t)},function(t){e.socket||e.reconnect()})}},{key:"reconnect",value:function(){var e=this;this.reconnectionObservable=Object(me.a)(this.reconnectInterval).pipe(Object(ve.a)(function(){return!e.socket})),this.reconnectionObservable.subscribe(function(){e.connect()},null,function(){e.reconnectionObservable=null,e.socket||(e.complete(),e.connectionObserver.complete())})}},{key:"send",value:function(e){this.socket.next(this.serializer(e))}}]),t}(fe.b),Ee=function e(t){Object(ee.a)(this,e);var a=t.bzz,n=t.ws;this.subject=new ye(n),this.client=new ie.SwarmClient({bzz:a,rpc:new oe.a(this.subject.socket)});var r=this;this.subject.connectionStatus.subscribe(function(e){e&&(r.client=new ie.SwarmClient({bzz:a,rpc:new oe.a(r.subject.socket)}))})},Oe=Object(f.a)();var je=a(32),ke=a(114),xe=a(327),we=a(42),Ce=a.n(we),Ne=a(335),Te=a(306),Se=a(307),Ae=a(67),ze=a(150),_e=a(34),Ke=a(297),Re=a(337),Pe=a(181),Be=a(300),Ie=a(302),We=a(301),De=a(303),Le=a(4),Fe=a(168),Me=a.n(Fe);var Ue=Object(Le.a)({icon:{overflow:"hidden",borderRadius:"50%"}})(function(e){var t=e.classes,a=e.publicKey,n=e.size,c=e.style;return r.a.createElement("div",{className:t.icon,style:Object(R.a)({width:n,height:n},c)},r.a.createElement(Me.a,{seed:a,size:8,scale:Math.ceil(n/8)}))}),He=function(e){function t(){var e,a;Object(ee.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(le.a)(this,(e=Object(ue.a)(t)).call.apply(e,[this].concat(r)))).state={anchorEl:null},a.handleMenu=function(e){a.setState({anchorEl:e.currentTarget})},a.handleClose=function(){a.setState({anchorEl:null})},a}return Object(pe.a)(t,e),Object(te.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.dispatch,n=e.account,c=e.errors,s=this.state.anchorEl,i=Boolean(s);if(c.length)return r.a.createElement(je.a,{to:"/settings"});var o=n.publicKey,l=n.username;return o?r.a.createElement(r.a.Fragment,null,r.a.createElement(Ke.a,{"aria-owns":i?"menu-account":void 0,"aria-haspopup":"true",onClick:this.handleMenu,color:"inherit"},r.a.createElement(Ue,{publicKey:o,size:32})),r.a.createElement(Pe.a,{id:"menu-account",anchorEl:s,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},open:i,onClose:this.handleClose},r.a.createElement(Re.a,{className:t.menu,onClick:function(){a(Object(_e.d)("/profile"))}},r.a.createElement(Be.a,null,r.a.createElement(We.a,null)),r.a.createElement(Ie.a,{primary:r.a.createElement(Ae.a,{color:"inherit",noWrap:!0},l||o)})),r.a.createElement(Re.a,{onClick:function(){a(Object(_e.d)("/settings"))}},r.a.createElement(Be.a,null,r.a.createElement(De.a,null)),r.a.createElement(Ie.a,{primary:r.a.createElement(Ae.a,{color:"inherit",noWrap:!0},"Settings")})))):null}}]),t}(n.Component),qe=Object(d.d)(Object(u.c)(function(e){var t=e||{account:{publicKey:"",username:""},errors:[]};return{account:t.account,errors:t.errors}}),Ce()(function(e){return{menu:{maxWidth:300}}}))(He),Ve=a(304),Ge=a(305),Je="/messenger/control";var Qe=Object(d.d)(Object(u.c)(function(e){return{router:(e||{router:{location:{}}}).router}}))(function(e){var t=e.router,a=e.dispatch,n=t.location;return r.a.createElement(r.a.Fragment,null,n.hash==="#".concat(Je)?r.a.createElement(Ke.a,{edge:"start",color:"inherit","aria-label":"Close",onClick:function(){a(_e.e.goBack())}},r.a.createElement(Ve.a,null)):r.a.createElement(Ke.a,{edge:"start",color:"inherit","aria-label":"Control panel",onClick:function(){a(Object(_e.d)(Je))}},r.a.createElement(Ge.a,null)))}),Xe=a(116),Ze=a.n(Xe);var $e=Object(d.d)(Object(u.c)(),Ce()(function(e){return{grow:{flexGrow:1},title:{color:"inherit",lineHeight:"2.4rem"},logo:{width:36,marginRight:e.spacing(2),display:"block",float:"left"}}}))(function(e){var t=e.classes,a=e.dispatch,n=e.isNarrow;return r.a.createElement(Te.a,{color:"default"},r.a.createElement(Se.a,null,n&&r.a.createElement(Qe,null),r.a.createElement(Ae.a,{variant:"h5",color:"inherit",noWrap:!0,className:t.grow},r.a.createElement(ze.a,{className:t.title,style:{textDecoration:"none"},onClick:function(){a(Object(_e.d)("/"))}},r.a.createElement("img",{src:Ze.a,alt:"Nebula",className:t.logo}),r.a.createElement(Ae.a,{variant:"h5",color:"inherit",noWrap:!0},"Nebula"))),r.a.createElement(qe,null)))}),Ye=a(308),et=a(172),tt=a.n(et),at=function(e){function t(){return Object(ee.a)(this,t),Object(le.a)(this,Object(ue.a)(t).apply(this,arguments))}return Object(pe.a)(t,e),Object(te.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.classes,n=t.errors;return r.a.createElement("div",{className:a.fixed},n.map(function(t,n){return r.a.createElement(Ye.a,{key:n,className:a.error,message:t,action:[r.a.createElement(Ke.a,{key:"close","aria-label":"Close",color:"inherit",onClick:function(){return e.dismiss(t)}},r.a.createElement(tt.a,{className:a.icon}))]})}))}},{key:"dismiss",value:function(e){this.props.dispatch(function(e){return function(){var t=Object(v.a)(g.a.mark(function t(a){return g.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:a({type:k,error:e});case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}(e))}}]),t}(n.Component),nt=Object(d.d)(Object(u.c)(function(e){return{errors:(e||[]).errors}}),Object(Le.a)(function(e){return{fixed:{position:"fixed",top:0,left:"50%",right:"auto",zIndex:1400,transform:"translateX(-50%)"},error:{backgroundColor:e.palette.error.dark}}}))(at),rt=a(173),ct=a.n(rt),st=function(e){function t(e){var a;return Object(ee.a)(this,t),(a=Object(le.a)(this,Object(ue.a)(t).call(this,e))).state={isOpen:!1},a}return Object(pe.a)(t,e),Object(te.a)(t,[{key:"componentWillUpdate",value:function(e){var t=this;this.props.isConnected||!e.isConnected||this.state.isOpen||(this.setState({isOpen:!0}),setTimeout(function(){t.setState({isOpen:!1})},3e3))}},{key:"render",value:function(){var e=this.props,t=e.classes,a=e.isStarted,n=e.isConnected,c=e.children,s=e.location.pathname;return a&&!n&&"/settings"!==s?r.a.createElement(je.a,{to:"/settings"}):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:t.fixed},this.state.isOpen&&r.a.createElement(Ye.a,{className:t.success,message:"Connected"}),!n&&r.a.createElement(Ye.a,{className:t.error,message:"No connection"})),c)}}]),t}(n.Component),it=Object(d.d)(Object(u.c)(function(e){return(e||{app:{isConnected:!1,isStarted:!1}}).app}),Object(Le.a)(function(e){return{fixed:{position:"fixed",top:6,left:"50%",right:"auto",zIndex:1400,transform:"translateX(-50%)"},success:{backgroundColor:ct.a[600]},error:{backgroundColor:e.palette.error.dark}}}))(Object(je.f)(st));var ot=Ce()(function(e){return{layout:{height:"100%",paddingTop:64}}})(function(e){var t=e.classes,a=e.children,n=e.isNarrow;return r.a.createElement(it,null,r.a.createElement(Ne.a,null),r.a.createElement($e,{isNarrow:n}),r.a.createElement("main",{className:t.layout},a),r.a.createElement(nt,null))}),lt=a(310),ut=a(309);var pt=Object(d.d)(Object(u.c)(),Ce()(function(e){return{logoContainer:{textAlign:"center",paddingTop:e.spacing(10),paddingBottom:e.spacing(8)},logo:{width:200,paddingBottom:e.spacing(2)},title:{color:"#e3e3e3"},apps:{textAlign:"center",paddingTop:e.spacing(6),paddingBottom:e.spacing(8)},app:{width:100,textAlign:"center",paddingLeft:e.spacing(8),paddingRight:e.spacing(8)},appIcon:{fontSize:100}}}))(function(e){var t=e.classes,a=e.dispatch;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:t.logoContainer},r.a.createElement("img",{src:Ze.a,alt:"Nebula",className:t.logo}),r.a.createElement(Ae.a,{variant:"h1",className:t.title},"Nebula")),r.a.createElement("div",{className:t.apps},r.a.createElement(ut.a,{className:t.app,onClick:function(){a(Object(_e.d)("/messenger"))}},r.a.createElement(Ae.a,null,r.a.createElement(lt.a,{className:t.appIcon}),"Messenger"))))}),dt=a(311),mt=a(184),ft=a(329),bt=a(314),ht=a(175),gt=a.n(ht),vt=a(174),yt=a.n(vt),Et=a(148),Ot=function(e){function t(e){var a;return Object(ee.a)(this,t),(a=Object(le.a)(this,Object(ue.a)(t).call(this,e))).reset=function(){a.props.dispatch(function(){var e=Object(v.a)(g.a.mark(function e(t){return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t({type:W,settings:{pss:I.pss,bzz:I.bzz,revealAddress:I.revealAddress}});case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}())},a.save=function(){var e=Object.assign({},a.props.settings,a.state),t=e.pss,n=e.bzz,r=e.revealAddress;a.props.dispatch(function(e){var t=e.pss,a=e.bzz,n=e.revealAddress;return function(){var e=Object(v.a)(g.a.mark(function e(r){return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r({type:W,settings:{pss:t,bzz:a,revealAddress:n}});case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()}({pss:t,bzz:n,revealAddress:r}))},a.state={},a}return Object(pe.a)(t,e),Object(te.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.classes,n=t.settings,c=t.app;return n.pss?r.a.createElement(dt.a,{container:!0,spacing:0,justify:"center",style:{paddingTop:10}},r.a.createElement(dt.a,{item:!0,md:6,sm:8,xs:11},!c.isConnected&&r.a.createElement(Ye.a,{className:a.info,message:r.a.createElement("div",null,"There is no connection. Make sure you did everything right in order to ",r.a.createElement("a",{href:"https://github.com/okamilab/nebula#running-nebula",target:"_block"},"run nebula"))}),r.a.createElement(Ae.a,{variant:"h5",color:"inherit",noWrap:!0,className:a.sectionTitle},"Settings"),r.a.createElement(Ae.a,{variant:"subtitle1",color:"inherit",noWrap:!0,className:a.sectionTitle},"General"),r.a.createElement(mt.a,{square:!0,className:a.section},r.a.createElement(dt.a,{container:!0,spacing:0},r.a.createElement(dt.a,{item:!0,xs:6},r.a.createElement(Ae.a,{variant:"subtitle1",color:"inherit",noWrap:!0},"PSS endpoint (WebSocket)")),r.a.createElement(dt.a,{item:!0,xs:6},r.a.createElement(ft.a,{id:"pss",onChange:function(t){return e.setState({pss:t.target.value})},defaultValue:n.pss})),r.a.createElement(dt.a,{item:!0,xs:12},r.a.createElement(Ae.a,{variant:"caption"},"After updating the field you need to restart the app (refresh page)")),r.a.createElement(dt.a,{item:!0,xs:12,className:a.divider},r.a.createElement(bt.a,null)),r.a.createElement(dt.a,{item:!0,xs:6},r.a.createElement(Ae.a,{variant:"subtitle1",color:"inherit",noWrap:!0},"BZZ endpoint")),r.a.createElement(dt.a,{item:!0,xs:6},r.a.createElement(ft.a,{id:"bzz",onChange:function(t){return e.setState({bzz:t.target.value})},defaultValue:n.bzz})),r.a.createElement(dt.a,{item:!0,xs:12},r.a.createElement(Ae.a,{variant:"caption"},"After updating the field you need to restart the app (refresh page)")),r.a.createElement(dt.a,{item:!0,xs:12,className:a.divider},r.a.createElement(bt.a,null)),r.a.createElement(dt.a,{item:!0,xs:6},r.a.createElement(Ae.a,{variant:"subtitle1",color:"inherit",noWrap:!0},"Local storage")),r.a.createElement(dt.a,{item:!0,xs:6},yt()(n.size)))),r.a.createElement(Ae.a,{variant:"subtitle1",color:"inherit",noWrap:!0,className:a.sectionTitle},"Security"),r.a.createElement(mt.a,{square:!0,className:a.section},r.a.createElement(dt.a,{container:!0,spacing:0},r.a.createElement(dt.a,{item:!0,xs:6},r.a.createElement(Ae.a,{variant:"subtitle1",color:"inherit",noWrap:!0},"Reveal address partially")),r.a.createElement(dt.a,{item:!0,xs:6},r.a.createElement(ft.a,{id:"revealAddress",select:!0,onChange:function(t){return e.setState({revealAddress:+t.target.value})},value:void 0===this.state.revealAddress?n.revealAddress:this.state.revealAddress},r.a.createElement(Re.a,{value:0},"Broadcast"),r.a.createElement(Re.a,{value:4},"4"),r.a.createElement(Re.a,{value:8},"8"),r.a.createElement(Re.a,{value:16},"16"),r.a.createElement(Re.a,{value:32},"Full"))))),r.a.createElement(Ae.a,{variant:"subtitle1",color:"inherit",noWrap:!0,className:a.sectionTitle},"About"),r.a.createElement(mt.a,{square:!0,className:a.section},r.a.createElement(dt.a,{container:!0,spacing:0},r.a.createElement(dt.a,{item:!0,xs:6},r.a.createElement(Ae.a,{variant:"subtitle1",color:"inherit",noWrap:!0},"Version")),r.a.createElement(dt.a,{item:!0,xs:6},r.a.createElement("a",{href:"https://github.com/okamilab/nebula/releases/tag/v".concat(Et.version),target:"_block"},Et.version)))),r.a.createElement("div",{className:a.actionBar},r.a.createElement(ut.a,{variant:"contained",onClick:this.reset,className:a.button},"Reset"),r.a.createElement(ut.a,{variant:"contained",color:"primary",onClick:this.save,className:a.button},"Save")))):r.a.createElement("div",null,"No data")}}]),t}(n.Component),jt=Object(d.d)(Object(u.c)(function(e){var t=e||{settings:{pss:I.pss,bzz:I.bzz,revealAddress:I.revealAddress,size:0},app:{isConnected:!1}};return{settings:t.settings,app:t.app}}),Object(Le.a)(function(e){return{sectionTitle:{marginTop:e.spacing(2)},section:{borderRadius:5,padding:e.spacing(2)},divider:{paddingTop:e.spacing(2),paddingBottom:e.spacing(2)},actionBar:{paddingTop:e.spacing(2)},button:{marginRight:e.spacing(2)},info:{backgroundColor:gt.a[300],color:"#000",maxWidth:"100%"}}}))(Ot),kt=a(31),xt=a(176),wt=a(313),Ct=a(312),Nt=a(338),Tt=a(315),St=a(336),At=a(316),zt=function(e){function t(e){var a;return Object(ee.a)(this,t),(a=Object(le.a)(this,Object(ue.a)(t).call(this,e))).state={tooltipOpen:!1,copied:!1},a.toggle=a.toggle.bind(Object(kt.a)(Object(kt.a)(a))),a}return Object(pe.a)(t,e),Object(te.a)(t,[{key:"toggle",value:function(){this.setState({tooltipOpen:!this.state.tooltipOpen,copied:this.state.tooltipOpen})}},{key:"render",value:function(){var e=this,t=this.props,a=t.name,n=t.value,c=t.label,s=t.classes;if(!n||!n.length)return null;var i=n.length>22?"".concat(n.substr(0,16),"...").concat(n.substr(n.length-4)):n;return r.a.createElement(wt.a,{margin:"normal"},r.a.createElement(Nt.a,{htmlFor:"".concat(a,"_key")},c),r.a.createElement(Ct.a,{id:"".concat(a,"_key"),type:"text",value:i,disabled:!0,className:s.input,endAdornment:r.a.createElement(Tt.a,{position:"end"},r.a.createElement(xt.CopyToClipboard,{id:"".concat(a,"_key"),text:n,onCopy:function(){return e.setState({copied:!0})}},r.a.createElement(St.a,{title:this.state.copied?"Copied":"Copy to clipboard",placement:"right",onClose:function(){setTimeout(function(){return e.setState({copied:!1})},200)}},r.a.createElement(Ke.a,null,r.a.createElement(At.a,{fontSize:"small"})))))}))}}]),t}(n.Component),_t=Object(Le.a)({input:{"&:before":{borderBottomStyle:"none!important"}}})(zt),Kt=function(e){function t(e){var a;return Object(ee.a)(this,t),(a=Object(le.a)(this,Object(ue.a)(t).call(this,e))).save=Object(v.a)(g.a.mark(function e(){var t,n;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=Object.assign({},a.props,a.state),n=t.username,e.next=3,a.props.dispatch(T(n));case 3:case"end":return e.stop()}},e)})),a.state={},a}return Object(pe.a)(t,e),Object(te.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.account,n=t.classes;if(!a)return r.a.createElement("div",null,"Loading");var c=a.username,s=a.publicKey,i=a.overlayAddress;return s?r.a.createElement(dt.a,{container:!0,spacing:0,justify:"center",style:{paddingTop:10}},r.a.createElement(dt.a,{item:!0,md:6,sm:8,xs:11},r.a.createElement(Ae.a,{variant:"h5",color:"inherit",noWrap:!0,className:n.sectionTitle},"Profile"),r.a.createElement(mt.a,{square:!0,className:n.section},r.a.createElement(dt.a,{container:!0,spacing:0},r.a.createElement(dt.a,{item:!0,xs:3},s?r.a.createElement(Ue,{publicKey:s,size:78}):null),r.a.createElement(dt.a,{item:!0,xs:6},r.a.createElement(ft.a,{id:"username",label:"User name",onChange:function(t){return e.setState({username:t.target.value})},defaultValue:c})),r.a.createElement(dt.a,{item:!0,xs:3},r.a.createElement(ut.a,{variant:"contained",color:"primary",onClick:this.save,className:n.button,disabled:!this.state.username},"Save")),r.a.createElement(dt.a,{item:!0,xs:3}),r.a.createElement(dt.a,{item:!0,xs:9},r.a.createElement(_t,{name:"publicKey",value:s,label:"Public key"})),r.a.createElement(dt.a,{item:!0,xs:3}),r.a.createElement(dt.a,{item:!0,xs:9},r.a.createElement(_t,{name:"overlayAddress",value:i,label:"Address"})))))):r.a.createElement("div",null,"No data")}}]),t}(n.Component),Rt=Object(d.d)(Object(u.c)(function(e){return{account:(e||{account:{publicKey:"",username:""}}).account}}),Object(Le.a)(function(e){return{sectionTitle:{marginTop:e.spacing(2)},section:{borderRadius:5,marginTop:e.spacing(2),padding:e.spacing(2)},button:{marginTop:e.spacing(2)}}}))(Kt),Pt=a(330),Bt=a(322),It=a(323),Wt=a(324),Dt=a(333),Lt=a(321),Ft=a(319),Mt=a(320),Ut=a(318),Ht=a(317),qt=function(e){function t(e){var a;return Object(ee.a)(this,t),(a=Object(le.a)(this,Object(ue.a)(t).call(this,e))).invite=Object(v.a)(g.a.mark(function e(){var t,n,r;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=a.state,n=t.publicKey,r=t.address,a.setState({error:null}),e.next=5,a.props.dispatch(Object(E.j)(n,r));case 5:e.next=11;break;case 7:return e.prev=7,e.t0=e.catch(0),a.setState({error:e.t0.message}),e.abrupt("return");case 11:a.toggle();case 12:case"end":return e.stop()}},e,null,[[0,7]])})),a.state={modal:!1,publicKey:"",address:"",error:""},a.toggle=a.toggle.bind(Object(kt.a)(Object(kt.a)(a))),a.onKeyPress=a.onKeyPress.bind(Object(kt.a)(Object(kt.a)(a))),a}return Object(pe.a)(t,e),Object(te.a)(t,[{key:"toggle",value:function(){this.setState({error:null,modal:!this.state.modal})}},{key:"onKeyPress",value:function(e){"Enter"===e.key&&this.state.publicKey&&this.invite()}},{key:"render",value:function(){var e=this,t=this.props.classes,a=this.state.error;return r.a.createElement(r.a.Fragment,null,r.a.createElement(Ke.a,{color:"inherit",onClick:this.toggle},r.a.createElement(Ht.a,null)),r.a.createElement(Dt.a,{open:this.state.modal,onClose:this.toggle,"aria-labelledby":"form-dialog-title"},r.a.createElement(Ut.a,{id:"form-dialog-title"},"Invite contact"),r.a.createElement(Ft.a,null,r.a.createElement(Mt.a,null,a?r.a.createElement(Ye.a,{message:a.message||a,className:t.error}):null),r.a.createElement(ft.a,{autoFocus:!0,margin:"dense",id:"contactAddress",label:"Contact public key *",type:"text",fullWidth:!0,onChange:function(t){return e.setState({publicKey:t.target.value})},onKeyPress:this.onKeyPress}),r.a.createElement(ft.a,{margin:"dense",id:"contactPublicKey",label:"Contact address",type:"text",fullWidth:!0,onChange:function(t){return e.setState({address:t.target.value})},onKeyPress:this.onKeyPress})),r.a.createElement(Lt.a,null,r.a.createElement(ut.a,{onClick:this.toggle,color:"default"},"Cancel"),r.a.createElement(ut.a,{onClick:this.invite,disabled:!this.state.publicKey,variant:"contained",color:"primary"},"Send request"))))}}]),t}(n.Component),Vt=Object(d.d)(Object(u.c)(),Object(Le.a)(function(e){return{error:{backgroundColor:e.palette.error.dark}}}))(qt),Gt=function(e){function t(){return Object(ee.a)(this,t),Object(le.a)(this,Object(ue.a)(t).apply(this,arguments))}return Object(pe.a)(t,e),Object(te.a)(t,[{key:"render",value:function(){var e=this.props,t=e.list,a=e.title,n=e.renderItem,c=e.classes;if(!t||!t.length)return null;var s=t.map(n);return r.a.createElement("div",{className:c.container},r.a.createElement(Ae.a,{variant:"subtitle1",color:"inherit"},a),s)}}]),t}(n.Component);Gt.defaultProps={renderItem:function(e,t){return r.a.createElement(Ae.a,{key:t,noWrap:!0},e.key)}};var Jt=Ce()(function(e){return{container:{paddingLeft:e.spacing(2),paddingRight:e.spacing(2),overflow:"hidden"}}})(Gt),Qt=function(e){function t(e){var a;return Object(ee.a)(this,t),(a=Object(le.a)(this,Object(ue.a)(t).call(this,e))).accept=function(){var e=a.props,t=e.publicKey,n=e.address;(0,e.dispatch)(Object(E.h)(t,n)),a.toggle()},a.decline=function(){var e=a.props,t=e.publicKey,n=e.address;(0,e.dispatch)(Object(E.i)(t,n)),a.toggle()},a.state={modal:!1},a.toggle=a.toggle.bind(Object(kt.a)(Object(kt.a)(a))),a}return Object(pe.a)(t,e),Object(te.a)(t,[{key:"toggle",value:function(){this.setState({modal:!this.state.modal})}},{key:"render",value:function(){var e=this.props.publicKey;return r.a.createElement("div",{onClick:this.toggle},r.a.createElement(Ae.a,{noWrap:!0},e),r.a.createElement(Dt.a,{open:this.state.modal,onClose:this.toggle,"aria-labelledby":"form-dialog-title"},r.a.createElement(Ut.a,{id:"form-dialog-title"},"Received contact"),r.a.createElement(Ft.a,null,r.a.createElement(Mt.a,null,r.a.createElement(Ae.a,{noWrap:!0},"Do you want to accept request from ",e,"?"))),r.a.createElement(Lt.a,null,r.a.createElement(ut.a,{onClick:this.decline,color:"default"},"Decline"),r.a.createElement(ut.a,{onClick:this.accept,variant:"contained",color:"primary"},"Accept"))))}}]),t}(n.Component),Xt=Object(d.d)(Object(u.c)())(Qt),Zt=a(71),$t=function(e){function t(){return Object(ee.a)(this,t),Object(le.a)(this,Object(ue.a)(t).apply(this,arguments))}return Object(pe.a)(t,e),Object(te.a)(t,[{key:"render",value:function(){var e=this.props,t=e.contacts,a=e.classes,n=e.dispatch,c=Object(Zt.b)(Object.values(t),"type");return r.a.createElement(r.a.Fragment,null,r.a.createElement(Se.a,null,r.a.createElement(Ae.a,{variant:"h6",color:"inherit",noWrap:!0,className:a.grow},"All"),r.a.createElement(Vt,null)),r.a.createElement(Jt,{list:c.sent_request,title:"Sent"}),r.a.createElement(Jt,{list:c.received_request,title:"Received",renderItem:function(e,t){return r.a.createElement(Xt,{key:t,publicKey:e.key,address:e.address})}}),r.a.createElement(Jt,{list:c.added,renderItem:function(e,t){return r.a.createElement(ze.a,{key:t,className:a.contact,style:{textDecoration:"none"},onClick:function(){n(Object(_e.d)("/messenger/contact/".concat(q()(e.key))))}},r.a.createElement("div",null,r.a.createElement(Ue,{publicKey:e.key,size:32})),r.a.createElement(Ae.a,{key:t,color:"inherit",className:a.contactTitle,noWrap:!0},e.username||e.key))}}))}}]),t}(n.Component),Yt=Object(d.d)(Object(u.c)(function(e){return{contacts:(e||{}).contacts}}),Object(Le.a)(function(e){return{grow:{flexGrow:1},contact:{display:"flex",color:"inherit"},contactTitle:{paddingLeft:e.spacing(1),lineHeight:"32px"}}}))($t),ea=function(e){function t(){return Object(ee.a)(this,t),Object(le.a)(this,Object(ue.a)(t).apply(this,arguments))}return Object(pe.a)(t,e),Object(te.a)(t,[{key:"render",value:function(){var e=this.props,t=e.chats,a=e.classes,n=e.dispatch;return r.a.createElement(r.a.Fragment,null,r.a.createElement(Se.a,null,r.a.createElement(Ae.a,{variant:"h6",color:"inherit",noWrap:!0},"Chats")),r.a.createElement("div",{className:a.container},t.map(function(e,t){return r.a.createElement(ze.a,{key:t,className:a.chat,style:{textDecoration:"none"},onClick:function(){n(Object(_e.d)("/messenger/chat/".concat(e.key)))}},r.a.createElement("div",null,r.a.createElement(Ue,{publicKey:e.key,size:32})),r.a.createElement(Ae.a,{key:t,color:"inherit",className:a.chatTitle,noWrap:!0},e.key))})))}}]),t}(n.Component),ta=Object(d.d)(Object(u.c)(function(e){return{chats:(e||[]).chats}}),Ce()(function(e){return{container:{paddingLeft:e.spacing(2),paddingRight:e.spacing(2),overflow:"hidden"},chat:{display:"flex",color:"inherit"},chatTitle:{paddingLeft:e.spacing(1),lineHeight:"32px"}}}))(ea),aa=function(e){function t(){var e,a;Object(ee.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(le.a)(this,(e=Object(ue.a)(t)).call.apply(e,[this].concat(r)))).state={value:0},a.handleChange=function(e,t){a.setState({value:t})},a}return Object(pe.a)(t,e),Object(te.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(Pt.a,{value:this.state.value,variant:"fullWidth",indicatorColor:"primary",textColor:"primary",onChange:this.handleChange},r.a.createElement(Bt.a,{icon:r.a.createElement(It.a,null),label:"Contacts"}),r.a.createElement(Bt.a,{icon:r.a.createElement(Wt.a,null),label:"Chats"})),this.state.value?r.a.createElement(ta,null):r.a.createElement(Yt,null))}}]),t}(n.Component);var na=Object(Le.a)({root:{flexGrow:1,maxWidth:500,height:"100%"}})(function(e){var t=e.classes;return r.a.createElement(mt.a,{square:!0,className:t.root},r.a.createElement(aa,null))});var ra=Ce()({container:{width:"100%",height:"100%",margin:0,padding:0},cell:{margin:0,padding:0,height:"100%"}})(function(e){var t=e.classes,a=e.children,n=e.isNarrow;return r.a.createElement(dt.a,{container:!0,spacing:0,className:t.container},!n&&r.a.createElement(dt.a,{item:!0,xs:3,className:t.cell},r.a.createElement(na,null)),r.a.createElement(dt.a,{item:!0,xs:n?12:9,className:t.cell},a))}),ca=function(e){function t(){return Object(ee.a)(this,t),Object(le.a)(this,Object(ue.a)(t).apply(this,arguments))}return Object(pe.a)(t,e),Object(te.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.isNarrow,n=e.contact,c=e.dispatch;if(!n)return r.a.createElement("div",null,"Contact not found");var s=n.username,i=n.key,o=n.address;return i?r.a.createElement(ra,{isNarrow:a},r.a.createElement(dt.a,{container:!0,spacing:0,justify:"center",style:{paddingTop:10}},r.a.createElement(dt.a,{item:!0,md:6,sm:8,xs:11},r.a.createElement(Ae.a,{variant:"h5",color:"inherit",noWrap:!0,className:t.sectionTitle},"Contact"),r.a.createElement(mt.a,{square:!0,className:t.section},r.a.createElement(dt.a,{container:!0,spacing:0},r.a.createElement(dt.a,{item:!0,xs:3},i?r.a.createElement(Ue,{publicKey:i,size:78}):null),r.a.createElement(dt.a,{item:!0,xs:9},r.a.createElement(ft.a,{id:"username",label:"User name",disabled:!0,defaultValue:s})),r.a.createElement(dt.a,{item:!0,xs:3}),r.a.createElement(dt.a,{item:!0,xs:9},r.a.createElement(_t,{name:"publicKey",value:i,label:"Public key"})),r.a.createElement(dt.a,{item:!0,xs:3}),r.a.createElement(dt.a,{item:!0,xs:9},r.a.createElement(_t,{name:"address",value:o,label:"Address"})))),r.a.createElement("div",{className:t.actionBar},r.a.createElement(ut.a,{variant:"contained",color:"primary",className:t.button,onClick:function(){c(Object(_e.d)("/messenger/chat/".concat(i)))}},"Chat"))))):r.a.createElement("div",null,"No data")}}]),t}(n.Component),sa=Object(d.d)(Object(u.c)(function(e,t){return{contact:(e||{}).contacts[t.match.params.key]}}),Object(Le.a)(function(e){return{sectionTitle:{marginTop:e.spacing(2)},section:{borderRadius:5,marginTop:e.spacing(2),padding:e.spacing(2)},actionBar:{paddingTop:e.spacing(2)},button:{marginRight:e.spacing(2)}}}))(ca),ia=a(38),oa=a(120),la=a(265),ua=a(325),pa=a(326),da=Object(Le.a)(function(e){return{divider:{textAlign:"center",borderBottom:"1px solid #ddd",lineHeight:"0.3em",margin:"10px 0 20px"},title:{background:e.palette.background.default,padding:"0 6px",color:"#bbb",fontSize:"12px"}}})(function(e){var t=e.classes,a=e.date;return r.a.createElement("div",{className:t.divider},r.a.createElement("span",{className:t.title},a.toLocaleDateString()))}),ma=function(e){function t(){var e,a;Object(ee.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(le.a)(this,(e=Object(ue.a)(t)).call.apply(e,[this].concat(r)))).download=function(e){e&&a.props.dispatch(Object(O.g)(e))},a}return Object(pe.a)(t,e),Object(te.a)(t,[{key:"renderMessageContent",value:function(){var e=this,t=this.props,a=t.classes,n=t.message,c=t.isOwn,s=n.text;switch(s.startsWith("bzz:/")){case!0:return r.a.createElement("div",{className:a.file},r.a.createElement("div",{className:a.fileName},"File: ",s.substr(5,15),"..."),r.a.createElement("hr",{className:a.divider}),r.a.createElement("div",{className:a.actionBar},r.a.createElement(ut.a,{onClick:function(){return e.download(s.substr(5))}},"Download")));default:return r.a.createElement("div",{className:"".concat(a.body," ").concat(c?a.ownedBody:null)},n.text)}}},{key:"renderMessage",value:function(){var e,t=this.props,a=t.classes,c=t.message,s=t.sender,i=t.isOwn,o=t.showHeader,l=new Date(c.timestamp);switch(i){case!0:return o&&(e=r.a.createElement("div",{className:a.header},l.toLocaleTimeString())),r.a.createElement(n.Fragment,null,e,this.renderMessageContent());default:var u=r.a.createElement("div",{style:{width:32}}),p=s.key,d=s.username;return o&&(u=r.a.createElement("div",null,r.a.createElement(Ue,{publicKey:p,size:32})),e=r.a.createElement("div",{className:a.header},d||"".concat(p.substr(0,8),"..."),", ",l.toLocaleTimeString())),r.a.createElement("div",{className:a.layout},u,r.a.createElement("div",{className:a.content},e,this.renderMessageContent()))}}},{key:"render",value:function(){var e=this.props,t=e.classes,a=e.isOwn;return r.a.createElement("div",{className:"".concat(t.block," ").concat(a?t.owned:null)},this.renderMessage())}}]),t}(n.Component),fa=Object(d.d)(Object(u.c)(),Object(Le.a)(function(e){return{file:{backgroundColor:"#f1f1f4",display:"inline-block",padding:10,borderRadius:6},fileName:{paddingTop:e.spacing(1)},divider:{marginTop:e.spacing(1),marginBottom:e.spacing(1)},actionBar:{textAlign:"center",paddingBottom:e.spacing(1)},block:{textAlign:"left",paddingTop:2},owned:{textAlign:"right",paddingRight:10},layout:{display:"flex"},content:{paddingLeft:e.spacing(1)},header:{fontSize:12,color:"#bbb"},body:{backgroundColor:"#f2f6f9",display:"inline-block",padding:"2px 10px",marginRight:10,borderRadius:6,textAlign:"left"},ownedBody:{backgroundColor:"#dbf4fd",marginRight:0,marginLeft:40}}}))(ma),ba=function(e){function t(e){var a;return Object(ee.a)(this,t),(a=Object(le.a)(this,Object(ue.a)(t).call(this,e))).send=function(){var e=a.props.id;a.props.dispatch(Object(O.j)(e,a.state.msg)),a.setState({msg:""})},a.upload=function(e){if(e.target.files.length){var t=a.props.id;a.props.dispatch(Object(O.i)(t,e.target.files[0]))}},a.state={msg:""},a.onChange=a.onChange.bind(Object(kt.a)(Object(kt.a)(a))),a.onKeyPress=a.onKeyPress.bind(Object(kt.a)(Object(kt.a)(a))),a}return Object(pe.a)(t,e),Object(te.a)(t,[{key:"componentDidMount",value:function(){this.scrollToBottom()}},{key:"componentDidUpdate",value:function(){this.scrollToBottom()}},{key:"scrollToBottom",value:function(){oa.scroller.scrollTo("bottom",{duration:400,delay:0,smooth:"easeInOutQuart",containerId:"scroll-container"})}},{key:"onChange",value:function(e){this.setState({msg:e.target.value})}},{key:"onKeyPress",value:function(e){"Enter"===e.key&&this.state.msg&&this.send()}},{key:"isSameDay",value:function(e,t){return e.getDay()===t.getDay()}},{key:"showMsgHeader",value:function(e,t,a){return 0===e||t.sender!==a.sender}},{key:"getParticipants",value:function(){var e=this.props,t=e.chat,a=e.account,n=e.contacts,r=a.publicKey,c=Object(ia.a)({},q()(r),{key:r});return Object.keys(t.participants).forEach(function(e){n[e]&&(c[e]=n[e])}),c}},{key:"render",value:function(){var e=this,t=this.props,a=t.classes,c=t.isNarrow,s=t.chat,i=t.account;if(!s)return r.a.createElement("div",null,"Chat not found");var o=this.getParticipants(),l=Object.values(s.messages).sort(function(e,t){return e.timestamp-t.timestamp}),u=i.publicKey;return r.a.createElement(r.a.Fragment,null,r.a.createElement(ra,{isNarrow:c},r.a.createElement(oa.Element,{id:"scroll-container",className:a.scrollContainer},r.a.createElement(dt.a,{container:!0,spacing:0,justify:"center"},r.a.createElement(dt.a,{item:!0,xs:10,lg:10,xl:8,className:a.list},l.map(function(t,a){var c=o[t.sender],s=new Date(t.timestamp),i=0===a||!e.isSameDay(s,new Date(l[a-1].timestamp));return r.a.createElement(n.Fragment,{key:a},i?r.a.createElement(da,{date:s}):null,r.a.createElement("div",null,r.a.createElement(fa,{message:t,sender:c,isOwn:c.key===u,showHeader:e.showMsgHeader(a,t,a>0?l[a-1]:null)||i})))}),r.a.createElement(oa.Element,{name:"bottom"}))))),r.a.createElement("div",{className:a.fixed},r.a.createElement(dt.a,{container:!0,spacing:0},!c&&r.a.createElement(dt.a,{item:!0,sm:3}),r.a.createElement(dt.a,{item:!0,xs:c?12:9},r.a.createElement(dt.a,{container:!0,spacing:0,justify:"center"},r.a.createElement(dt.a,{item:!0,xs:10,lg:10,xl:8},r.a.createElement(mt.a,{className:a.root,elevation:1},r.a.createElement(la.a,{className:a.input,placeholder:"Type a message here",value:this.state.msg,onChange:this.onChange,onKeyPress:this.onKeyPress,autoFocus:!0}),r.a.createElement("input",{type:"file",name:"file",id:"file",className:a.file,onChange:this.upload}),r.a.createElement("label",{htmlFor:"file",className:a.fileLabel},r.a.createElement(Ke.a,{className:a.iconButton,component:"span"},r.a.createElement(ua.a,null))),r.a.createElement(bt.a,{className:a.divider}),r.a.createElement(Ke.a,{className:a.iconButton,onClick:this.send,disabled:!this.state.msg},r.a.createElement(pa.a,null)))))))))}}]),t}(n.Component),ha=Object(d.d)(Object(u.c)(function(e,t){var a=e||{chats:[],account:{},contacts:{}},n=a.chats,r=a.account,c=a.contacts,s=t.match.params.key;return{id:s,chat:n.find(function(e){return e.key===s}),account:r,contacts:c}}),Object(Le.a)(function(e){return{scrollContainer:{height:"100%",overflow:"scroll"},list:{paddingBottom:80},root:{marginTop:e.spacing(4),marginBottom:e.spacing(4),marginRight:e.spacing(2),padding:"2px 4px",display:"flex"},input:{marginLeft:8,flex:1},file:{width:.1,height:.1,opacity:0,overflow:"hidden",position:"absolute",zIndex:"-1",cursor:"pointer"},fileLabel:{margin:0},iconButton:{padding:10},divider:{width:1,height:28,marginTop:8,marginBottom:8,marginLeft:4,marginRight:4},fixed:{position:"fixed",left:0,right:0,bottom:0}}}))(ba),ga=function(e){function t(){return Object(ee.a)(this,t),Object(le.a)(this,Object(ue.a)(t).apply(this,arguments))}return Object(pe.a)(t,e),Object(te.a)(t,[{key:"componentDidMount",value:function(){(0,this.props.dispatch)(function(){var e=Object(v.a)(g.a.mark(function e(t,a,n){return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t({type:S}),n().connection.subscribe(function(e){e?(t({type:A}),t(function(){var e=Object(v.a)(g.a.mark(function e(t,a,n){var r,c,s,i,o,l,u,p,d;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t({type:w}),e.prev=1,r=n(),c=r.client,e.next=5,Promise.all([c.pss.getPublicKey(),c.pss.baseAddr()]);case 5:s=e.sent,i=Object(y.a)(s,2),o=i[0],l=i[1],u=a(),p=u.app,d=p[o]||{},t((m={publicKey:o,overlayAddress:l,username:d.username},{type:C,account:m})),t(Object(E.k)(o)),t(Object(O.h)(o)),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(1),t(x(e.t0.message));case 19:case"end":return e.stop()}var m},e,null,[[1,16]])}));return function(t,a,n){return e.apply(this,arguments)}}())):t({type:z})},function(e){t(x(e.message))});case 3:case"end":return e.stop()}},e)}));return function(t,a,n){return e.apply(this,arguments)}}())}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,this.props.children)}}]),t}(r.a.Component),va=Object(u.c)()(ga);a(261);var ya=Object(d.d)(Object(u.c)(function(e){return{settings:(e||{settings:{mode:"full",home:"/"}}).settings}}))(function(e){var t=e.settings,a=Object(ke.a)(),n=!Object(xe.a)(a.breakpoints.up("md"))||"narrow"===t.mode;return r.a.createElement(va,null,r.a.createElement(l.a,{titleTemplate:"Nebula - %s"}),r.a.createElement(ot,{isNarrow:n},r.a.createElement(je.d,null,r.a.createElement(je.b,{exact:!0,path:t.home,component:pt}),r.a.createElement(je.b,{exact:!0,path:"/settings",component:jt}),r.a.createElement(je.b,{exact:!0,path:"/profile",component:Rt}),r.a.createElement(je.b,{exact:!0,path:"/messenger",render:function(e){return r.a.createElement(ra,Object.assign({},e,{isNarrow:n}))}}),r.a.createElement(je.b,{exact:!0,path:"/messenger/contact/:key",render:function(e){return r.a.createElement(sa,Object.assign({},e,{isNarrow:n}))}}),r.a.createElement(je.b,{exact:!0,path:"/messenger/chat/:key",render:function(e){return r.a.createElement(ha,Object.assign({},e,{isNarrow:n}))}}),r.a.createElement(je.b,{exact:!0,path:"/messenger/control",render:function(e){return r.a.createElement(aa,Object.assign({},e,{isNarrow:n}))}}))))});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Ea=a(178),Oa=new URLSearchParams(window.location.search),ja=function(e){var t=d.d,a=new se("nebula"),n={bzz:(e=a.deriveInitialState(e)).app.bzz||I.bzz,ws:e.app.pss||I.pss},r=new Ee(n),c=[Object(b.a)(Oe),a.middleware(),m.a.withExtraArgument(function(){return{client:r.client,connection:r.subject.connectionStatus}})],s=[d.a.apply(void 0,c)];return Object(d.e)($(Oe),e,t.apply(void 0,s))}({settings:{mode:"true"===(Oa.get("narrow")||"").toLowerCase()?"narrow":"full",home:Oa.get("home")||"/"}});s.a.render(r.a.createElement(i.AppContainer,null,r.a.createElement(o.HelmetProvider,null,r.a.createElement(u.a,{store:ja},r.a.createElement(p.a,{history:Oe},r.a.createElement(ya,null))))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()}),Object(Ea.run)(ja)},30:function(e,t,a){"use strict";var n=a(88),r=a(6),c=a.n(r),s=a(24),i=a(38),o=a(15),l=a(93),u=a(183),p=a(264),d=a(36),m=a.n(d),f=/^0x[0-9a-f]{130}$/,b={isValidPubKey:function(e,t,a){if(e===t)throw new Error("Invalid contact key: this is your own key");if(!f.test(e))throw new Error('Invalid contact key: must be an hexadecimal string prefixed with "0x"');if(a)throw new Error("The contact already present in your list of contacts");return!0}},h=a(35),g=a(71);a.d(t,"a",function(){return v}),a.d(t,"g",function(){return y}),a.d(t,"f",function(){return E}),a.d(t,"e",function(){return O}),a.d(t,"d",function(){return j}),a.d(t,"b",function(){return k}),a.d(t,"c",function(){return x}),a.d(t,"k",function(){return S}),a.d(t,"j",function(){return A}),a.d(t,"h",function(){return K}),a.d(t,"i",function(){return R});var v="CONTACTS_RESTORE",y="CONTACT_SUBSCRIBE",E="CONTACT_REQUEST",O="CONTACT_RECEIVE",j="CONTACT_MUTATE",k="CONTACT_ACCEPT",x="CONTACT_DECLINE";function w(e){return{key:e.key,data:e.msg.toObject()}}function C(e,t){return N.apply(this,arguments)}function N(){return(N=Object(o.a)(c.a.mark(function e(t,a){var n,r;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.pss.stringToTopic(a);case 2:return n=e.sent,e.next=5,t.pss.createTopicSubscription(n);case 5:return r=e.sent,e.abrupt("return",r.pipe(Object(u.a)(w),Object(p.a)(function(e){return"contact_request"===e.data.type&&null!=e.data.payload&&null!=e.data.payload.topic||"contact_response"===e.data.type}),Object(u.a)(function(e){return{key:e.key,type:e.data.type,payload:e.data.payload}})));case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}function T(e,t){return function(){var a=Object(o.a)(c.a.mark(function a(n){var r,o,l,u,p,d;return c.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(r=t(),o=r.contacts,l=m()(n.key),u=o[l],"contact_request"!==n.type||null!=u&&"received_request"!==u.type){a.next=8;break}p={key:n.key,type:"received_request",topic:n.payload.topic,username:n.payload.username,address:n.payload.overlay_address},e({type:O,contacts:Object(i.a)({},l,p)}),a.next=16;break;case 8:if("contact_response"!==n.type||null==u||"sent_declined"!==u.type&&"sent_request"!==u.type){a.next=14;break}d=Object(s.a)({},u,{type:!0===n.payload.contact?"added":"sent_declined",username:n.payload.username,address:n.payload.overlay_address}),e({type:j,contacts:Object(i.a)({},l,d)}),n.payload.contact&&e(Object(h.f)(d)),a.next=16;break;case 14:return console.error("unhandled event",n),a.abrupt("return");case 16:case"end":return a.stop()}},a)}));return function(e){return a.apply(this,arguments)}}()}function S(e){return function(){var t=Object(o.a)(c.a.mark(function t(a,n){var r,s,i,l;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:r=n(),s=r.app,i=s[e]||{},l=i.contacts||{},a({type:v,contacts:l}),a(function(){var e=Object(o.a)(c.a.mark(function e(t,a,n){var r,s,i,o,l,u;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=a(),s=r.account,i=n(),o=i.client,e.next=4,C(o,s.publicKey);case 4:l=e.sent,u=l.subscribe(T(t,a)),t({type:y,sub:u});case 7:case"end":return e.stop()}},e)}));return function(t,a,n){return e.apply(this,arguments)}}());case 5:case"end":return t.stop()}},t)}));return function(e,a){return t.apply(this,arguments)}}()}function A(e,t){return function(){var a=Object(o.a)(c.a.mark(function a(r,s,o){var u,p,d,f,h,v,y,O,j,k,x,w,C,N;return c.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return u=s(),p=u.account,d=u.contacts,f=u.settings,h=Object(l.hexValueType)(e),v=m()(h),b.isValidPubKey(h,p.publicKey,d[v]),y=o(),O=y.client,a.next=7,Promise.all([O.pss.stringToTopic(h),O.pss.stringToTopic(Math.random().toString(36).slice(2))]);case 7:return j=a.sent,k=Object(n.a)(j,2),x=k[0],w=k[1],a.next=13,O.pss.setPeerPublicKey(h,x,t||"0x");case 13:return C={type:"contact_request",payload:{username:p.username,message:null,topic:w,overlay_address:Object(g.a)(p.overlayAddress,f.revealAddress)},utc_timestamp:Date.now()},a.next=16,O.pss.sendAsym(h,x,C);case 16:N={key:h,topic:w,type:"sent_request"},r({type:E,contacts:Object(i.a)({},v,N)});case 18:case"end":return a.stop()}},a)}));return function(e,t,n){return a.apply(this,arguments)}}()}function z(e,t,a,n,r){return _.apply(this,arguments)}function _(){return(_=Object(o.a)(c.a.mark(function e(t,a,n,r,i){var o,l,u,p,d,m;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.pss.stringToTopic(n);case 2:if(o=e.sent,l={contact:i},!i){e.next=9;break}return u=a(),p=u.account,d=u.settings,l=Object(s.a)({},l,{username:p.username,overlay_address:Object(g.a)(p.overlayAddress,d.revealAddress)}),e.next=9,t.pss.setPeerPublicKey(n,o,r||"0x");case 9:return m={type:"contact_response",payload:l,utc_timestamp:Date.now()},e.next=12,t.pss.sendAsym(n,o,m);case 12:case"end":return e.stop()}},e)}))).apply(this,arguments)}function K(e,t){return function(){var a=Object(o.a)(c.a.mark(function a(n,r,o){var l,u,p,d,f,b;return c.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return l=r(),u=l.contacts,p=o(),d=p.client,a.next=4,z(d,r,e,t,!0);case 4:f=m()(e),b=Object(s.a)({},u[f],{type:"added"}),n({type:k,contacts:Object(i.a)({},f,b)}),n(Object(h.f)(b));case 8:case"end":return a.stop()}},a)}));return function(e,t,n){return a.apply(this,arguments)}}()}function R(e,t){return function(){var a=Object(o.a)(c.a.mark(function a(n,r,o){var l,u,p,d,f,b;return c.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return l=r(),u=l.contacts,p=o(),d=p.client,a.next=4,z(d,r,e,t,!1);case 4:f=m()(e),b=Object(s.a)({},u[f],{type:"received_declined"}),n({type:x,contacts:Object(i.a)({},f,b)});case 7:case"end":return a.stop()}},a)}));return function(e,t,n){return a.apply(this,arguments)}}()}},35:function(e,t,a){"use strict";a.d(t,"a",function(){return b}),a.d(t,"b",function(){return h}),a.d(t,"e",function(){return g}),a.d(t,"d",function(){return v}),a.d(t,"c",function(){return y}),a.d(t,"h",function(){return N}),a.d(t,"f",function(){return T}),a.d(t,"j",function(){return z}),a.d(t,"i",function(){return _}),a.d(t,"g",function(){return K});var n=a(88),r=a(38),c=a(6),s=a.n(c),i=a(15),o=a(183),l=a(264),u=a(36),p=a.n(u),d=a(164),m=a.n(d),f=a(71),b="CHATS_RESTORE",h="CHAT_CREATE",g="CHAT_SUBSCRIBE",v="CHAT_SEND_MESSAGE",y="CHAT_RECEIVE_MESSAGE";function E(e){return{key:e.key,data:e.msg.toObject()}}function O(e,t){var a=t.find(function(t){return t.key===e});if(!a)throw new Error("Chat is not found");return a}function j(e,t){return k.apply(this,arguments)}function k(){return(k=Object(i.a)(s.a.mark(function e(t,a){var r,c,i;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([t.pss.createTopicSubscription(a.topic),t.pss.setPeerPublicKey(a.key,a.topic,a.address)]);case 2:return r=e.sent,c=Object(n.a)(r,1),i=c[0],e.abrupt("return",i.pipe(Object(o.a)(E),Object(l.a)(function(e){return"chat_message"===e.data.type&&null!=e.data.payload}),Object(o.a)(function(e){return{key:e.key,type:e.data.type,utc_timestamp:e.data.utc_timestamp,payload:e.data.payload}})));case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function x(e,t){return function(){var a=Object(i.a)(s.a.mark(function a(n){var r,c,i,o;return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(r=t(),c=r.chats,i=O(n.key,c),o={sender:p()(n.key),isRead:!1,text:n.payload.text,timestamp:n.utc_timestamp},!i.messages[p()(o)]){a.next=6;break}return a.abrupt("return");case 6:e({type:y,key:i.key,message:o});case 7:case"end":return a.stop()}},a)}));return function(e){return a.apply(this,arguments)}}()}function w(e){return function(){var t=Object(i.a)(s.a.mark(function t(a,n,r){var c,i,o,l;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return c=r(),i=c.client,t.next=3,j(i,e);case 3:o=t.sent,l=o.subscribe(x(a,n)),a({type:g,sub:l});case 6:case"end":return t.stop()}},t)}));return function(e,a,n){return t.apply(this,arguments)}}()}function C(e,t){t.map(function(t){return e(w(t))})}function N(e){return function(){var t=Object(i.a)(s.a.mark(function t(a,n){var r,c,i,o;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:r=n(),c=r.app,i=c[e]||{},o=i.chats||[],a({type:b,chats:o}),C(a,o);case 5:case"end":return t.stop()}},t)}));return function(e,a){return t.apply(this,arguments)}}()}function T(e){return function(){var t=Object(i.a)(s.a.mark(function t(a,n){var c,i,o,l;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:i=n(),o=i.account,l={key:e.key,topic:e.topic,address:e.address,participants:(c={},Object(r.a)(c,p()(e.key),e.key),Object(r.a)(c,p()(o.publicKey),o.publicKey),c),messages:{}},a({type:h,chat:l}),a(w(l));case 4:case"end":return t.stop()}},t)}));return function(e,a){return t.apply(this,arguments)}}()}function S(e,t,a,n,r){return A.apply(this,arguments)}function A(){return(A=Object(i.a)(s.a.mark(function e(t,a,n,r,c){var i,o;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i={type:"chat_message",payload:{text:c},utc_timestamp:Date.now()},e.next=3,a.pss.sendAsym(n.key,n.topic,i);case 3:o={sender:p()(r),isRead:!0,timestamp:Date.now(),text:c},t({type:v,key:n.key,message:o});case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}function z(e,t){return function(){var a=Object(i.a)(s.a.mark(function a(n,r,c){var i,o,l,u,p,d;return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:i=r(),o=i.account,l=i.chats,u=O(e,l),p=c(),d=p.client,S(n,d,u,o.publicKey,t);case 4:case"end":return a.stop()}},a)}));return function(e,t,n){return a.apply(this,arguments)}}()}function _(e,t){return function(){var a=Object(i.a)(s.a.mark(function a(n,r,c){var i,o,l,u,p,d,m,b,h,g,v;return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return i=r(),o=i.account,l=i.chats,u=O(e,l),p=c(),d=p.client,m=d.bzz,a.next=6,Object(f.c)(t);case 6:return b=a.sent,h=b.currentTarget.result,a.next=10,m.uploadFile(h,{contentType:t.type});case 10:g=a.sent,v="bzz:/".concat(g),S(n,d,u,o.publicKey,v);case 13:case"end":return a.stop()}},a)}));return function(e,t,n){return a.apply(this,arguments)}}()}function K(e){return function(){var t=Object(i.a)(s.a.mark(function t(a,n,r){var c,i,o,l;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return c=r(),i=c.client,o=i.bzz,t.next=4,o.download(e);case 4:return l=t.sent,t.t0=m.a,t.next=8,l.blob();case 8:return t.t1=t.sent,t.next=11,t.t0.saveAs.call(t.t0,t.t1);case 11:case"end":return t.stop()}},t)}));return function(e,a,n){return t.apply(this,arguments)}}()}},71:function(e,t,a){"use strict";a.d(t,"b",function(){return n}),a.d(t,"c",function(){return r}),a.d(t,"a",function(){return c});var n=function(e,t){return e.reduce(function(e,a){return(e[a[t]]=e[a[t]]||[]).push(a),e},{})},r=function(e){return new Promise(function(t,a){var n=new FileReader;n.onload=t,n.readAsArrayBuffer(e)})},c=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.substring(0,2+2*t)||"0x"}}},[[199,1,2]]]);
//# sourceMappingURL=main.e96f41a0.chunk.js.map