{"version":3,"sources":["images/logo.svg","api/index.js","api/chats.js","base/error/actions.js","account/actions.js","app/actions.js","app/reducer.js","account/reducer.js","base/default.js","settings/actions.js","settings/reducer.js","messenger/contacts/reducer.js","messenger/chats/reducer.js","base/subscription/reducer.js","base/error/reducer.js","base/reducer.js","base/middlewares/localStorage.js","base/RxWebSocketSubject.js","base/clientResolver.js","base/redux.js","base/components/Identicon.jsx","account/components/AccountMenu.jsx","messenger/components/ControlPanelButton.jsx","base/components/Header.jsx","base/error/components/Error.jsx","base/containers/ConnectionController.jsx","base/containers/Layout.jsx","settings/pages/Settings.jsx","base/components/Key.jsx","account/pages/Profile.jsx","messenger/contacts/components/ContactListGroup.jsx","messenger/contacts/components/ContactRequest.jsx","messenger/contacts/components/ContactList.jsx","messenger/contacts/components/ContactInvite.jsx","messenger/chats/components/ChatList.jsx","messenger/components/ControlPanel.jsx","messenger/components/LeftSide.jsx","messenger/components/Layout.jsx","messenger/contacts/pages/Contact.jsx","messenger/chats/components/ChatDayDivider.jsx","messenger/chats/components/ChatMessage.jsx","messenger/chats/pages/Chat.jsx","base/containers/Startup.jsx","App.jsx","serviceWorker.js","index.js","base/httpClient.js","base/key.js","messenger/contacts/api.js","messenger/contacts/actions.js","messenger/chats/actions.js","base/fn.js"],"names":["module","exports","__webpack_require__","p","registry","Object","_home_circleci_repo_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_0__","chatRegistry","run","store","window","addEventListener","event","data","type","console","error","handleMessage","log","_home_circleci_repo_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__","_ref","publicKey","dispatch","state","getState","hash","sum","chats","push","concat","inviteContact","ERROR_CATCHED","ERROR_DISMISS","addError","asyncToGenerator","regenerator_default","a","mark","_callee","wrap","_context","prev","next","stop","_x","apply","this","arguments","ACCOUNT_REQUEST","ACCOUNT_RECEIVE","ACCOUNT_MUTATE","updateUsername","username","_ref4","_callee2","_context2","account","_x4","APP_CONNECTING","APP_CONNECTED","APP_DISCONNECTED","initialState","isStarted","isConnected","raw","reduce","length","undefined","assign","isLoading","overlayAddress","action","objectSpread","DEFAULT_SETTINGS","pss","bzz","revealAddress","SETTINGS_MUTATE","size","mode","home","settings","CONTACTS_RESTORE","CONTACT_REQUEST","CONTACT_RECEIVE","CONTACT_MUTATE","CONTACT_ACCEPT","contacts","CONTACT_DECLINE","rest","objectWithoutProperties","map","_toPropertyKey","CHATS_RESTORE","CHAT_CREATE","CHAT_SEND_MESSAGE","CHAT_RECEIVE_MESSAGE","chat","reducer_toPropertyKey","newChat","messages","message","defineProperty","CHAT_SUBSCRIBE","CONTACT_SUBSCRIBE","toConsumableArray","sub","filter","reducer","history","combineReducers","router","connectRouter","app","subscriptions","errors","LocalStorageMiddleware","key","classCallCheck","trackFields","excludeActionTypes","_this","get","path","parts","split","value","index","part","hasOwnProperty","call","storeState","_state$settings","model","unpack","jsonpack","pack","compressed","LZString","compress","localStorage","setItem","prevState","nextState","includes","abrupt","some","v","preloadedState","getItem","isPssLocked","uncompressed","decompress","RxWebSocketSubject","url","reconnectInterval","resultSelector","serializer","possibleConstructorReturn","getPrototypeOf","defaultResultSelector","e","JSON","parse","defaultSerializer","stringify","connectionStatus","Observable","observer","connectionObserver","pipe","share","distinctUntilChanged","wsSubjectConfig","closeObserver","socket","openObserver","connect","subscribe","reconnectionObservable","reconnect","_this2","WebSocketSubject","m","_","_this3","interval","takeWhile","complete","Subject","ClientResolver","config","ws","subject","client","SwarmClient","rpc","StreamRPC","createHashHistory","withStyles","icon","overflow","borderRadius","classes","style","react_default","createElement","className","width","height","dist_main_default","seed","scale","Math","ceil","AccountMenu","anchorEl","handleMenu","setState","currentTarget","handleClose","_this$props","props","open","Boolean","react_router","to","Fragment","IconButton","aria-owns","aria-haspopup","onClick","color","components_Identicon","Menu","id","anchorOrigin","vertical","horizontal","transformOrigin","onClose","MenuItem","menu","ListItemIcon","AccountCircle","ListItemText","primary","Typography","noWrap","esm_Settings","Component","compose","maxWidth","location","pathname","edge","aria-label","routerActions","goBack","Close","esm_Menu","theme","grow","flexGrow","title","lineHeight","logo","marginRight","spacing","display","float","isNarrow","AppBar","Toolbar","components_ControlPanelButton","variant","ButtonBase","textDecoration","src","alt","components_AccountMenu","Error","fixed","i","SnackbarContent","dismiss","Close_default","_ref2","_x2","dismissError","position","top","left","right","zIndex","transform","backgroundColor","palette","dark","ConnectionController","isOpen","nextProps","setTimeout","children","success","green","withRouter","layout","paddingTop","containers_ConnectionController","CssBaseline","components_Header","components_Error","Settings","reset","_ref3","save","_Object$assign","updateSettings","Grid","container","justify","item","md","sm","xs","info","href","target","sectionTitle","Paper","square","section","TextField","onChange","defaultValue","disabled","divider","Divider","pretty","select","packageJson","version","actionBar","Button","button","marginTop","padding","paddingBottom","amber","Key","tooltipOpen","copied","toggle","bind","assertThisInitialized","name","label","substr","FormControl","margin","InputLabel","htmlFor","Input","input","endAdornment","InputAdornment","react_copy_to_clipboard_lib","text","onCopy","Tooltip","placement","FileCopy","fontSize","&:before","borderBottomStyle","Profile","components_Key","ContactListGroup","list","renderItem","items","List","subheader","ListSubheader","defaultProps","c","ListItem","disableTypography","ContactRequest","accept","address","acceptContact","decline","_this$props2","declineContact","modal","Dialog","aria-labelledby","DialogTitle","DialogContent","DialogContentText","component","DialogActions","ContactList","groupBy","values","components_ContactListGroup","components_ContactRequest","ExpansionPanel","root","border","boxShadow","&:not(:last-child)","borderBottom","&$expanded","expanded","MuiExpansionPanel","ExpansionPanelSummary","minHeight","content","&::after","bottom","borderTop","MuiExpansionPanelSummary","ExpansionPanelDetails","MuiExpansionPanelDetails","ContactInvite","invite","_this$state","isInviting","t0","isInvitiong","onKeyPress","stopPropagation","_this$state2","Add","fullWidth","autoFocus","ContactInvite_ExpansionPanel","ContactInvite_ExpansionPanelSummary","expandIcon","ExpandMore","ContactInvite_ExpansionPanelDetails","CircularProgress","background","ChatList","disablePadding","transition","&:hover","MuiIconButton","ControlPanel","isContactsOpen","isChatsOpen","Contacts","ListItemSecondaryAction","components_ContactInvite","ControlPanel_IconButton","ExpandLess","Collapse","in","components_ContactList","esm_Chat","components_ChatList","components_ControlPanel","cell","components_LeftSide","Contact","contact","components_Layout","match","params","textAlign","default","date","toLocaleDateString","ChatMessage","download","isOwn","startsWith","file","fileName","body","ownedBody","react_emoji_render_lib_default","svg","header","sender","showHeader","time","Date","timestamp","toLocaleTimeString","react","renderMessageContent","identicon","_this$props3","block","owned","renderMessage","marginBottom","paddingRight","paddingLeft","marginLeft","MuiMenu","Chat","showEP","anchorEP","hideEP","addEmoji","emoji","msg","native","send","sendMessage","upload","files","sendFile","isOpenEP","scrollToBottom","scroller","scrollTo","duration","delay","smooth","containerId","curTime","prevTime","getDay","curMsg","prevMsg","participants","keys","forEach","k","getParticipants","sort","b","modules","scrollContainer","lg","xl","showDayDivider","isSameDay","components_ChatDayDivider","components_ChatMessage","showMsgHeader","elevation","InputBase","placeholder","iconButton","Mood","Send","Chat_Menu","keepMounted","dist_es","onSelect","flex","opacity","cursor","fileLabel","Startup","resolve","connection","_resolve","_getState","session","Promise","all","getPublicKey","baseAddr","sent","slicedToArray","restoreContacts","restoreChats","_x3","err","React","useTheme","useMediaQuery","breakpoints","up","containers_Startup","lib_default","titleTemplate","containers_Layout","exact","render","pages_Contact","pages_Chat","hostname","dotenv","urlParams","URLSearchParams","search","httpClient","axios","create","baseURL","process","reduxCompose","localStorageMiddleware","deriveInitialState","clientResolver","middleware","routerMiddleware","thunk","withExtraArgument","enhancers","applyMiddleware","createStore","configureStore","toLowerCase","ReactDOM","react_hot_loader","lib","es","esm","src_App","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister","apiRun","PUBLIC_KEY_RE","isValidPubKey","test","validatePubKey","ensurePrefix","fetchPublicKey","_fetchPublicKey","query","decodePssEvent","toObject","createSubscription","_callee7","topic","subscription","_context7","stringToTopic","createTopicSubscription","payload","handler","existing","_contact","_contact2","overlay_address","createChat","_callee3","_getState3","_context3","_getState2","_x5","_x6","_x7","_x8","_callee4","_resolve2","_getState4","publicKeyHex","_ref5","_ref6","contactTopic","sharedTopic","pssMessage","_context4","keyUtils","api","hexValueType","random","toString","slice","setPeerPublicKey","getAddress","utc_timestamp","now","sendAsym","_x9","_x10","_x11","sendResponse","_callee8","_getState6","_context8","_ref7","_callee5","_getState5","_resolve3","_context5","_x17","_x18","_x19","_ref8","_callee6","_resolve4","_context6","_x20","_x21","_x22","getChat","_ref9","_home_circleci_repo_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_2___default","_home_circleci_repo_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__","_home_circleci_repo_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_3__","isRead","subscribeAll","_participants","_home_circleci_repo_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_1__","_callee9","_context9","_x16","readEvent","buffer","readFile","result","uploadFile","contentType","__","FileSaver","blob","t1","saveAs","_x23","_x24","d","__webpack_exports__","rv","x","fr","FileReader","onload","readAsArrayBuffer","reveal","substring"],"mappings":"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","file":"static/js/main.74009250.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/logo.1584bb37.svg\";","import { registry as chatRegistry } from './chats';\nexport * from './contacts';\n\nconst registry = { ...chatRegistry };\n\nfunction handleMessage(store, data) {\n  if (!data && !data.type) {\n    console.error('Nebula::Message is invalid');\n    return;\n  }\n\n  if (!registry[data.type]) {\n    console.error('Nebula::Handler not found');\n    return;\n  }\n\n  return registry[data.type](store, data);\n}\n\nexport function run(store) {\n  window.addEventListener('message', function (event) {\n    return handleMessage(store, event.data);\n  }, false);\n\n  console.log('Nebula::APIs started');\n}","import { push } from 'connected-react-router';\nimport sum from 'hash-sum';\n\nimport { inviteContact } from './../messenger/contacts/actions';\n\nexport const CHAT_OPEN = '@NEBULA::CHAT_OPEN';\n\nfunction open(store, { publicKey }) {\n  const { dispatch, getState } = store;\n  const state = getState();\n  const hash = sum(publicKey);\n\n  const chat = state.chats[hash];\n  if (chat) {\n    dispatch(push(`/messenger/chat/${hash}`));\n    return;\n  }\n\n  dispatch(inviteContact(publicKey));\n}\n\nexport const registry = {\n  [CHAT_OPEN]: open\n};","export const ERROR_CATCHED = 'ERROR_CATCHED';\nexport const ERROR_DISMISS = 'ERROR_DISMISS';\n\nexport function addError(error) {\n  return async (dispatch) => {\n    dispatch({ type: ERROR_CATCHED, error });\n  };\n}\n\nexport function dismissError(error) {\n  return async (dispatch) => {\n    dispatch({ type: ERROR_DISMISS, error });\n  };\n}","import { restoreContacts } from './../messenger/contacts/actions';\nimport { restoreChats } from './../messenger/chats/actions';\nimport { addError } from './../base/error/actions';\n\nexport const ACCOUNT_REQUEST = 'ACCOUNT_REQUEST';\nexport const ACCOUNT_RECEIVE = 'ACCOUNT_RECEIVE';\nexport const ACCOUNT_MUTATE = 'ACCOUNT_MUTATE';\n\nexport function fetchAccount() {\n  return async (dispatch, getState, resolve) => {\n    dispatch({ type: ACCOUNT_REQUEST });\n\n    try {\n      const { client } = resolve();\n      const [publicKey, overlayAddress] =\n        await Promise.all([\n          client.pss.getPublicKey(),\n          client.pss.baseAddr(),\n        ]);\n\n      const { app } = getState();\n      const session = app[publicKey] || {};\n      dispatch(receiveAccount({ publicKey, overlayAddress, username: session.username }));\n\n      dispatch(restoreContacts(publicKey));\n      dispatch(restoreChats(publicKey));\n    } catch (error) {\n      dispatch(addError(error.message));\n    }\n  };\n}\n\nfunction receiveAccount(account) {\n  return {\n    type: ACCOUNT_RECEIVE,\n    account\n  };\n}\n\nexport function updateUsername(username) {\n  return async (dispatch) => {\n    dispatch({\n      type: ACCOUNT_MUTATE,\n      account: { username }\n    });\n  };\n}","import { fetchAccount } from './../account/actions';\nimport { addError } from './../base/error/actions';\n\nexport const APP_CONNECTING = 'APP_CONNECTING';\nexport const APP_CONNECTED = 'APP_CONNECTED';\nexport const APP_DISCONNECTED = 'APP_DISCONNECTED';\n\nexport function connect() {\n  return async (dispatch, _, resolve) => {\n    dispatch({ type: APP_CONNECTING });\n\n    const { connection } = resolve();\n    connection.subscribe(\n      (isConnected) => {\n        if (isConnected) {\n          dispatch({ type: APP_CONNECTED });\n          dispatch(fetchAccount());\n        } else {\n          dispatch({ type: APP_DISCONNECTED });\n        }\n      },\n      (err) => {\n        dispatch(addError(err.message));\n      }\n    );\n  };\n}","import {\n  APP_CONNECTED,\n  APP_DISCONNECTED\n} from './actions';\n\nexport const initialState = {\n  isStarted: false,\n  isConnected: false,\n  raw: ''\n};\n\nexport default function reduce(state = initialState, action) {\n  switch (action.type) {\n    case APP_CONNECTED: {\n      return Object.assign({}, state, {\n        isStarted: true,\n        isConnected: true\n      });\n    }\n    case APP_DISCONNECTED: {\n      return Object.assign({}, state, {\n        isStarted: true,\n        isConnected: false\n      });\n    }\n    default:\n      return state;\n  }\n}","import {\n  ACCOUNT_REQUEST,\n  ACCOUNT_RECEIVE,\n  ACCOUNT_MUTATE\n} from './actions';\n\nexport const initialState = {\n  isLoading: false,\n  publicKey: '',\n  overlayAddress: '',\n  username: ''\n};\n\nexport default function reduce(state = initialState, action) {\n  switch (action.type) {\n    case ACCOUNT_REQUEST: {\n      return Object.assign({}, state, {\n        isLoading: true\n      });\n    }\n    case ACCOUNT_RECEIVE: {\n      return Object.assign({}, state, {\n        isLoading: false,\n        ...action.account\n      });\n    }\n    case ACCOUNT_MUTATE: {\n      return Object.assign({}, state, {\n        ...action.account\n      });\n    }\n    default:\n      return state;\n  }\n}","export const DEFAULT_SETTINGS = {\n  pss: 'ws://127.0.0.1:8546',\n  bzz: 'http://127.0.0.1:8500',\n  revealAddress: 4\n}","import { DEFAULT_SETTINGS } from '../base/default';\n\nexport const SETTINGS_MUTATE = 'SETTINGS_MUTATE';\n\nexport function updateSettings({ pss, bzz, revealAddress }) {\n  return async (dispatch) => {\n    dispatch({\n      type: SETTINGS_MUTATE,\n      settings: { pss, bzz, revealAddress }\n    });\n  };\n}\n\nexport function resetSettings() {\n  return async (dispatch) => {\n    dispatch({\n      type: SETTINGS_MUTATE,\n      settings: {\n        pss: DEFAULT_SETTINGS.pss,\n        bzz: DEFAULT_SETTINGS.bzz,\n        revealAddress: DEFAULT_SETTINGS.revealAddress\n      }\n    });\n  };\n}","import {\n  SETTINGS_MUTATE\n} from './actions';\n\nexport const initialState = {\n  bzz: '',\n  pss: '',\n  revealAddress: 0,\n  size: 0,\n  mode: 'full',\n  home: '/'\n};\n\nexport default function reduce(state = initialState, action) {\n  switch (action.type) {\n    case SETTINGS_MUTATE: {\n      return Object.assign({}, state, {\n        ...action.settings\n      });\n    }\n    default:\n      return state;\n  }\n}","import {\n  CONTACTS_RESTORE,\n  CONTACT_REQUEST,\n  CONTACT_RECEIVE,\n  CONTACT_MUTATE,\n  CONTACT_ACCEPT,\n  CONTACT_DECLINE\n} from './actions';\n\nexport const initialState = {};\n\nexport default function reduce(state = initialState, action) {\n  switch (action.type) {\n    case CONTACTS_RESTORE:\n    case CONTACT_REQUEST:\n    case CONTACT_RECEIVE:\n    case CONTACT_MUTATE:\n    case CONTACT_ACCEPT: {\n      return Object.assign({}, state, {\n        ...action.contacts\n      });\n    }\n    case CONTACT_DECLINE: {\n      const { [action.hash]: _, ...rest } = state;\n      return Object.assign({}, rest);\n    }\n    default:\n      return state;\n  }\n}","import sum from 'hash-sum';\n\nimport {\n  CHATS_RESTORE,\n  CHAT_CREATE,\n  CHAT_SEND_MESSAGE,\n  CHAT_RECEIVE_MESSAGE\n} from './actions';\n\nexport const initialState = {};\n\nexport default function reduce(state = initialState, action) {\n  switch (action.type) {\n    case CHATS_RESTORE:\n    case CHAT_CREATE: {\n      return Object.assign({}, state, {\n        ...action.chats\n      });\n    }\n    case CHAT_SEND_MESSAGE:\n    case CHAT_RECEIVE_MESSAGE: {\n      const { [action.hash]: chat, ...chats } = state;\n      const newChat = Object.assign({}, chat);\n\n      newChat.messages[sum(action.message)] = action.message;\n      return Object.assign({}, { [action.hash]: newChat }, chats);\n    }\n    default:\n      return state;\n  }\n}","import { CONTACT_SUBSCRIBE } from './../../messenger/contacts/actions';\nimport { CHAT_SUBSCRIBE } from './../../messenger/chats/actions';\n\nexport const initialState = [];\n\nexport default function reduce(state = initialState, action) {\n  switch (action.type) {\n    case CHAT_SUBSCRIBE:\n    case CONTACT_SUBSCRIBE: {\n      return [...state, action.sub];\n    }\n    default:\n      return state;\n  }\n}","import {\n  ERROR_CATCHED,\n  ERROR_DISMISS\n} from './actions';\n\nexport const initialState = [];\n\nexport default function reduce(state = initialState, action) {\n  switch (action.type) {\n    case ERROR_CATCHED: {\n      return [...state, action.error];\n    }\n    case ERROR_DISMISS: {\n      return state.filter((error) => error !== action.error);\n    }\n    default:\n      return state;\n  }\n}","import { combineReducers } from 'redux';\nimport { connectRouter } from 'connected-react-router';\n\nimport app from './../app/reducer';\nimport account from './../account/reducer';\nimport settings from './../settings/reducer';\nimport contacts from './../messenger/contacts/reducer';\nimport chats from './../messenger/chats/reducer';\nimport subscriptions from './../base/subscription/reducer';\nimport errors from './../base/error/reducer';\n\nexport default (history) => combineReducers({\n  router: connectRouter(history),\n  app,\n  account,\n  settings,\n  contacts,\n  chats,\n  subscriptions,\n  errors\n});","import jsonpack from 'jsonpack';\nimport LZString from 'lz-string';\n\nimport { DEFAULT_SETTINGS } from './../../base/default';\n\nexport default class LocalStorageMiddleware {\n  constructor(key) {\n    this.key = key;\n    this.trackFields = [\n      'account.username',\n      'settings.pss',\n      'settings.bzz',\n      'settings.revealAddress',\n      'contacts',\n      'chats'\n    ];\n    this.excludeActionTypes = [\n      'ACCOUNT_REQUEST',\n      'ACCOUNT_RECEIVE',\n      'CONTACTS_RESTORE',\n      'CONTACT_SUBSCRIBE',\n      'CHATS_RESTORE',\n      'CHAT_SUBSCRIBE',\n    ];\n  }\n\n  middleware() {\n    const get = (state, path) => {\n      const parts = path.split('.');\n      let value = state;\n\n      for (let index = 0; index < parts.length; index++) {\n        const part = parts[index];\n\n        if (Object.hasOwnProperty.call(value, part)) {\n          value = value[part];\n        } else {\n          return undefined;\n        }\n      }\n\n      return value;\n    };\n\n    const storeState = (state) => {\n      const { pss, bzz, revealAddress } = state.settings;\n\n      const model = {\n        ...this.unpack(state.app.raw),\n        ...{\n          pss,\n          bzz,\n          revealAddress\n        }\n      };\n\n      const publicKey = get(state, 'account.publicKey');\n      if (publicKey) {\n        const username = get(state, 'account.username');\n        model[publicKey] = {\n          username,\n          contacts: state.contacts,\n          chats: state.chats,\n        };\n      }\n\n      const value = jsonpack.pack(model);\n      const compressed = LZString.compress(value);\n      localStorage.setItem(this.key, compressed);\n    }\n\n    return (store) => (next) => async (action) => {\n      const prevState = store.getState();\n      await next(action);\n      if (!action.type || this.excludeActionTypes.includes(action.type)) {\n        return;\n      }\n\n      const nextState = store.getState();\n      const diff = this.trackFields.some(v => {\n        const prev = get(prevState, v);\n        const next = get(nextState, v);\n        return prev !== next;\n      })\n\n      if (diff) {\n        storeState(nextState);\n      }\n    }\n  }\n\n  deriveInitialState(preloadedState) {\n    const raw = localStorage.getItem(this.key);\n    const state = this.unpack(raw);\n\n    const { settings, ...rest } = preloadedState;\n    const { pss } = settings;\n\n    return {\n      app: { ...state, raw },\n      settings: {\n        ...settings,\n        isPssLocked: !!pss,\n        pss: pss || state.pss || DEFAULT_SETTINGS.pss,\n        bzz: state.bzz || DEFAULT_SETTINGS.bzz,\n        revealAddress: state.revealAddress === undefined ? DEFAULT_SETTINGS.revealAddress : state.revealAddress,\n        size: (raw || '').length,\n      },\n      ...rest\n    };\n  }\n\n  unpack(raw) {\n    const uncompressed = LZString.decompress(raw);\n    return uncompressed ? jsonpack.unpack(uncompressed) : {};\n  }\n}","import { Subject, Observable, interval } from 'rxjs';\nimport { WebSocketSubject } from 'rxjs/webSocket';\nimport { distinctUntilChanged, share, takeWhile } from 'rxjs/operators';\n\nexport default class RxWebSocketSubject extends Subject {\n  constructor(\n    url,\n    reconnectInterval = 5000, /// pause between connection\n    resultSelector,\n    serializer) {\n\n    super();\n    this.url = url;\n    this.reconnectInterval = reconnectInterval;\n    this.resultSelector = resultSelector;\n    this.serializer = serializer;\n\n    /// by default, when a message is received from the server, trying to decode it as JSON\n    this.defaultResultSelector = (e) => {\n      return JSON.parse(e.data);\n    };\n\n    /// when sending a message, encode it to JSON\n    this.defaultSerializer = (data) => {\n      return JSON.stringify(data);\n    };\n\n    /// connection status\n    this.connectionStatus = new Observable((observer) => {\n      this.connectionObserver = observer;\n    }).pipe(share())\n      .pipe(distinctUntilChanged());\n\n    if (!resultSelector) {\n      this.resultSelector = this.defaultResultSelector;\n    }\n\n    if (!this.serializer) {\n      this.serializer = this.defaultSerializer;\n    }\n\n    /// config for WebSocketSubject\n    /// except the url, here is closeObserver and openObserver to update connection status\n    this.wsSubjectConfig = {\n      url: url,\n      closeObserver: {\n        next: (e) => {\n          this.socket = null;\n          this.connectionObserver.next(false);\n        }\n      },\n      openObserver: {\n        next: (e) => {\n          this.connectionObserver.next(true);\n        }\n      }\n    };\n\n    this.connect();\n\n    /// follow the connection status and run the reconnect while losing the connection\n    this.connectionStatus.subscribe((isConnected) => {\n      if (!this.reconnectionObservable && typeof (isConnected) == \"boolean\" && !isConnected) {\n        this.reconnect();\n      }\n    });\n  }\n\n  connect() {\n    this.socket = new WebSocketSubject(this.wsSubjectConfig);\n    this.socket.subscribe((m) => {\n      this.next(m); /// when receiving a message, we just send it to our Subject\n    }, (_) => {\n      if (!this.socket) {\n        /// in case of an error with a loss of connection, we restore it\n        this.reconnect();\n      }\n    });\n  }\n\n  /// WebSocket Reconnect handling\n  reconnect() {\n    this.reconnectionObservable = interval(this.reconnectInterval)\n      .pipe(takeWhile(() => {\n        return !this.socket;\n      }));\n\n    this.reconnectionObservable.subscribe(() => {\n      this.connect();\n    }, null, () => {\n      /// if the reconnection attempts are failed, then we call complete of our Subject and status\n      this.reconnectionObservable = null;\n      if (!this.socket) {\n        this.complete();\n        this.connectionObserver.complete();\n      }\n    });\n  }\n\n  /// sending the message\n  send(data) {\n    this.socket.next(this.serializer(data));\n  }\n}\n","import { SwarmClient } from '@erebos/swarm-browser';\nimport StreamRPC from '@mainframe/rpc-stream';\n\nimport RxWebSocketSubject from './RxWebSocketSubject';\n\nexport default class ClientResolver {\n  constructor(config) {\n    const { bzz, ws } = config;\n\n    this.subject = new RxWebSocketSubject(ws);\n    this.client = new SwarmClient({\n      bzz,\n      rpc: new StreamRPC(this.subject.socket)\n    });\n\n    const _this = this;\n    this.subject.connectionStatus.subscribe(\n      (isConnected) => {\n        if (!isConnected) {\n          return;\n        }\n\n        _this.client = new SwarmClient({\n          bzz,\n          rpc: new StreamRPC(_this.subject.socket)\n        });\n      }\n    );\n  }\n}","import { applyMiddleware, createStore, compose as reduxCompose } from 'redux';\nimport thunk from 'redux-thunk';\nimport { createHashHistory } from 'history';\nimport { routerMiddleware } from 'connected-react-router';\n\nimport reducer from './reducer';\nimport LocalStorageMiddleware from './middlewares/localStorage';\nimport ClientResolver from './clientResolver';\n\nexport const history = createHashHistory();\n\nexport function configureStore(initialState, httpClient) {\n  // Use compose function provided by Redux DevTools if the extension is installed.\n  const compose = (process.env.NODE_ENV === 'development'\n    && typeof window === 'object'\n    && window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__)\n    || reduxCompose;\n\n  const localStorageMiddleware = new LocalStorageMiddleware('nebula');\n  initialState = localStorageMiddleware.deriveInitialState(initialState);\n\n  const config = {\n    bzz: initialState.settings.bzz,\n    ws: initialState.settings.pss,\n  };\n  const clientResolver = new ClientResolver(config);\n\n  const middleware = [\n    routerMiddleware(history),\n    localStorageMiddleware.middleware(),\n    thunk.withExtraArgument(() => {\n      return {\n        client: clientResolver.client,\n        connection: clientResolver.subject.connectionStatus,\n        httpClient\n      }\n    })\n  ];\n  const enhancers = [applyMiddleware(...middleware)];\n  const store = createStore(reducer(history), initialState, compose(...enhancers));\n\n  // Hot-reloading\n  if (module.hot && process.env.NODE_ENV === 'development') {\n    module.hot.accept('./reducer', () => {\n      store.replaceReducer(require('./reducer').default);\n    });\n  }\n\n  return store;\n}","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { withStyles } from '@material-ui/core/styles';\nimport Blockies from 'react-blockies';\n\nconst styles = {\n  icon: {\n    overflow: 'hidden',\n    borderRadius: '50%'\n  }\n};\n\nfunction Identicon({ classes, publicKey, size, style }) {\n  return (\n    <div className={classes.icon} style={{ width: size, height: size, ...style }}>\n      <Blockies seed={publicKey} size={8} scale={Math.ceil(size / 8)} />\n    </div>\n  )\n}\n\nIdenticon.propTypes = {\n  classes: PropTypes.object.isRequired,\n  publicKey: PropTypes.string.isRequired,\n  size: PropTypes.number.isRequired,\n  style: PropTypes.object\n};\n\nexport default withStyles(styles)(Identicon)","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport { compose } from 'redux';\nimport { connect } from 'react-redux';\nimport { Redirect } from 'react-router';\nimport withStyles from '@material-ui/core/styles/withStyles';\nimport IconButton from '@material-ui/core/IconButton';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport Menu from '@material-ui/core/Menu';\nimport Typography from '@material-ui/core/Typography';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport { AccountCircle, Settings } from '@material-ui/icons';\nimport { push } from 'connected-react-router';\n\nimport Identicon from '../../base/components/Identicon';\n\nconst styles = _ => ({\n  menu: {\n    maxWidth: 300,\n  },\n});\n\nclass AccountMenu extends Component {\n  state = {\n    anchorEl: null,\n  };\n\n  handleMenu = event => {\n    this.setState({ anchorEl: event.currentTarget });\n  };\n\n  handleClose = () => {\n    this.setState({ anchorEl: null });\n  };\n\n  render() {\n    const { classes, dispatch, account, errors } = this.props;\n    const { anchorEl } = this.state;\n    const open = Boolean(anchorEl);\n\n    if (errors.length) {\n      return <Redirect to={'/settings'} />;\n    }\n\n    const { publicKey, username } = account;\n    if (!publicKey) return null;\n\n    return (\n      <>\n        <IconButton\n          aria-owns={open ? 'menu-account' : undefined}\n          aria-haspopup='true'\n          onClick={this.handleMenu}\n          color='inherit'\n        >\n          <Identicon publicKey={publicKey} size={32} />\n        </IconButton>\n        <Menu\n          id='menu-account'\n          anchorEl={anchorEl}\n          anchorOrigin={{\n            vertical: 'top',\n            horizontal: 'right',\n          }}\n          transformOrigin={{\n            vertical: 'top',\n            horizontal: 'right',\n          }}\n          open={open}\n          onClose={this.handleClose}\n        >\n          <MenuItem\n            className={classes.menu}\n            onClick={() => { dispatch(push('/profile')) }}>\n            <ListItemIcon>\n              <AccountCircle />\n            </ListItemIcon>\n            <ListItemText primary={\n              <Typography color='inherit' noWrap>\n                {username || publicKey}\n              </Typography>\n            } />\n          </MenuItem>\n          <MenuItem onClick={() => { dispatch(push('/settings')) }}>\n            <ListItemIcon>\n              <Settings />\n            </ListItemIcon>\n            <ListItemText primary={\n              <Typography color='inherit' noWrap>\n                Settings\n              </Typography>\n            } />\n          </MenuItem>\n        </Menu>\n      </>\n    );\n  }\n}\n\nAccountMenu.propTypes = {\n  classes: PropTypes.object.isRequired,\n  dispatch: PropTypes.func.isRequired,\n  account: PropTypes.object,\n  errors: PropTypes.array\n};\n\nexport default compose(\n  connect((state) => {\n    const { account, errors } = state || {\n      account: {\n        publicKey: '',\n        username: ''\n      },\n      errors: []\n    };\n    return { account, errors };\n  }),\n  withStyles(styles)\n)(AccountMenu);","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { compose } from 'redux';\nimport { connect } from 'react-redux';\nimport IconButton from '@material-ui/core/IconButton';\nimport { Menu, Close } from '@material-ui/icons';\nimport { routerActions } from 'connected-react-router';\nimport { push } from 'connected-react-router';\n\nconst path = '/messenger/control';\n\nfunction ControlPanelButton({ router, dispatch }) {\n  const { location } = router;\n\n  return (\n    <>\n      {location.pathname === path ?\n        <IconButton edge='start' color='inherit' aria-label='Close'\n          onClick={() => { dispatch(routerActions.goBack()) }}>\n          <Close />\n        </IconButton> :\n        <IconButton edge='start' color='inherit' aria-label='Control panel'\n          onClick={() => { dispatch(push(path)) }}>\n          <Menu />\n        </IconButton>\n      }\n    </>\n  );\n}\n\nControlPanelButton.propTypes = {\n  dispatch: PropTypes.func.isRequired,\n  router: PropTypes.object,\n};\n\nexport default compose(\n  connect((state) => {\n    const { router } = state || {\n      router: {\n        location: {}\n      }\n    };\n    return { router };\n  })\n)(ControlPanelButton);","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { compose } from 'redux';\nimport { connect } from 'react-redux';\nimport withStyles from '@material-ui/core/styles/withStyles';\nimport AppBar from '@material-ui/core/AppBar';\nimport Toolbar from '@material-ui/core/Toolbar';\nimport Typography from '@material-ui/core/Typography';\nimport ButtonBase from '@material-ui/core/ButtonBase';\nimport { push } from 'connected-react-router';\n\nimport AccountMenu from './../../account/components/AccountMenu';\nimport ControlPanelButton from './../../messenger/components/ControlPanelButton';\nimport logo from './../../images/logo.svg';\n\nconst styles = theme => ({\n  grow: {\n    flexGrow: 1,\n  },\n  title: {\n    color: 'inherit',\n    lineHeight: '2.4rem'\n  },\n  logo: {\n    width: 36,\n    marginRight: theme.spacing(2),\n    display: 'block',\n    float: 'left'\n  }\n});\n\nfunction Header({ classes, dispatch, isNarrow }) {\n  return (\n    <AppBar color='default'>\n      <Toolbar>\n        {isNarrow && <ControlPanelButton />}\n        <Typography variant='h5' color='inherit' noWrap className={classes.grow}>\n          <ButtonBase\n            className={classes.title}\n            style={{ textDecoration: 'none' }}\n            onClick={() => { dispatch(push('/')) }}>\n            <img src={logo} alt='Nebula' className={classes.logo} />\n            <Typography variant='h5' color='inherit' noWrap>Nebula</Typography>\n          </ButtonBase>\n        </Typography>\n        <AccountMenu />\n      </Toolbar>\n    </AppBar>\n  );\n}\n\nHeader.propTypes = {\n  classes: PropTypes.object.isRequired,\n  dispatch: PropTypes.func.isRequired,\n  isNarrow: PropTypes.bool\n};\n\nexport default compose(\n  connect(),\n  withStyles(styles)\n)(Header);","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport { compose } from 'redux';\nimport { connect } from 'react-redux';\nimport { withStyles } from '@material-ui/core/styles';\nimport SnackbarContent from '@material-ui/core/SnackbarContent';\nimport IconButton from '@material-ui/core/IconButton';\nimport CloseIcon from '@material-ui/icons/Close';\n\nimport { dismissError } from './../actions';\n\nconst styles = theme => ({\n  fixed: {\n    position: \"fixed\",\n    top: 0,\n    left: '50%',\n    right: 'auto',\n    zIndex: 1400,\n    transform: 'translateX(-50%)'\n  },\n  error: {\n    backgroundColor: theme.palette.error.dark\n  }\n});\n\nclass Error extends Component {\n  render() {\n    const { classes, errors } = this.props;\n\n    return (\n      <div className={classes.fixed}>\n        {\n          errors.map((error, i) =>\n            <SnackbarContent\n              key={i}\n              className={classes.error}\n              message={error}\n              action={[\n                <IconButton\n                  key=\"close\"\n                  aria-label=\"Close\"\n                  color=\"inherit\"\n                  onClick={() => this.dismiss(error)}\n                >\n                  <CloseIcon className={classes.icon} />\n                </IconButton>\n              ]} />\n          )\n        }\n      </div>\n    );\n  }\n\n  dismiss(error) {\n    this.props.dispatch(dismissError(error));\n  }\n}\n\nError.propTypes = {\n  classes: PropTypes.object.isRequired,\n  dispatch: PropTypes.func.isRequired,\n  errors: PropTypes.array,\n};\n\nexport default compose(\n  connect((state) => {\n    const { errors } = state || [];\n    return { errors };\n  }),\n  withStyles(styles)\n)(Error);","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport { compose } from 'redux';\nimport { connect } from 'react-redux';\nimport { withRouter, Redirect } from 'react-router';\nimport { withStyles } from '@material-ui/core/styles';\nimport SnackbarContent from '@material-ui/core/SnackbarContent';\nimport green from '@material-ui/core/colors/green';\n\nconst styles = theme => ({\n  fixed: {\n    position: \"fixed\",\n    top: 6,\n    left: '50%',\n    right: 'auto',\n    zIndex: 1400,\n    transform: 'translateX(-50%)'\n  },\n  success: {\n    backgroundColor: green[600],\n  },\n  error: {\n    backgroundColor: theme.palette.error.dark,\n  }\n});\n\nclass ConnectionController extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      isOpen: false\n    };\n  }\n\n  componentWillUpdate(nextProps) {\n    if (!this.props.isConnected && nextProps.isConnected && !this.state.isOpen) {\n      this.setState({ isOpen: true });\n      setTimeout(() => { this.setState({ isOpen: false }) }, 3000);\n    }\n  }\n\n  render() {\n    const { classes, isStarted, isConnected, children, location } = this.props;\n    const { pathname } = location;\n\n    if (isStarted && !isConnected && pathname !== '/settings') {\n      return <Redirect to={'/settings'} />;\n    }\n\n    return (\n      <>\n        <div className={classes.fixed}>\n          {this.state.isOpen && <SnackbarContent className={classes.success} message=\"Connected\" />}\n          {!isConnected && <SnackbarContent className={classes.error} message=\"No connection\" />}\n        </div>\n        {children}\n      </>\n    );\n  }\n}\n\nConnectionController.propTypes = {\n  classes: PropTypes.object.isRequired,\n  isConnected: PropTypes.bool,\n  isStarted: PropTypes.bool,\n  children: PropTypes.node\n};\n\nexport default compose(\n  connect((state) => {\n    const { app } = state || {\n      app: {\n        isConnected: false,\n        isStarted: false\n      }\n    };\n    return app;\n  }),\n  withStyles(styles)\n)(withRouter(ConnectionController));","import React from 'react';\nimport PropTypes from 'prop-types';\nimport withStyles from '@material-ui/core/styles/withStyles';\nimport CssBaseline from '@material-ui/core/CssBaseline';\n\nimport Header from './../components/Header';\nimport Error from './../error/components/Error';\nimport ConnectionController from './ConnectionController';\n\nconst styles = _ => ({\n  layout: {\n    height: '100%',\n    paddingTop: 64\n  }\n});\n\nfunction Layout({ classes, children, isNarrow }) {\n  return (\n    <ConnectionController>\n      <CssBaseline />\n      <Header isNarrow={isNarrow} />\n      <main className={classes.layout}>\n        {children}\n      </main>\n      <Error />\n    </ConnectionController>\n  );\n}\n\nLayout.propTypes = {\n  classes: PropTypes.object.isRequired,\n  children: PropTypes.node,\n  isNarrow: PropTypes.bool\n};\n\nexport default withStyles(styles)(Layout);","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport { compose } from 'redux';\nimport { connect } from 'react-redux';\nimport { withStyles } from '@material-ui/core/styles';\nimport Grid from '@material-ui/core/Grid';\nimport Typography from '@material-ui/core/Typography';\nimport Paper from '@material-ui/core/Paper';\nimport TextField from '@material-ui/core/TextField';\nimport Divider from '@material-ui/core/Divider';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport Button from '@material-ui/core/Button';\nimport SnackbarContent from '@material-ui/core/SnackbarContent';\nimport amber from '@material-ui/core/colors/amber';\nimport pretty from 'prettysize';\n\nimport packageJson from '../../../package.json';\nimport { DEFAULT_SETTINGS } from '../../base/default';\nimport { updateSettings, resetSettings } from './../../settings/actions';\n\nconst styles = theme => ({\n  sectionTitle: {\n    marginTop: theme.spacing(2),\n  },\n  section: {\n    borderRadius: 5,\n    padding: theme.spacing(2)\n  },\n  divider: {\n    paddingTop: theme.spacing(2),\n    paddingBottom: theme.spacing(2)\n  },\n  actionBar: {\n    paddingTop: theme.spacing(2)\n  },\n  button: {\n    marginRight: theme.spacing(2),\n  },\n  info: {\n    backgroundColor: amber[300],\n    color: '#000',\n    maxWidth: '100%'\n  }\n});\n\nclass Settings extends Component {\n  constructor(props) {\n    super(props)\n\n    this.state = {};\n  }\n\n  render() {\n    const { classes, settings, app } = this.props;\n    if (!settings.pss) {\n      return <div>No data</div>\n    }\n\n    return (\n      <Grid\n        container\n        spacing={0}\n        justify='center'\n        style={{ paddingTop: 10 }}\n      >\n        <Grid item md={6} sm={8} xs={11}>\n          {!app.isConnected && <SnackbarContent\n            className={classes.info}\n            message={\n              <div>There is no connection. Make sure you did everything right in order\n                to <a href='https://github.com/okamilab/nebula#running-nebula' target='_block'>run nebula</a></div>\n            } />}\n          <Typography variant='h5' color='inherit' noWrap className={classes.sectionTitle}>\n            Settings\n          </Typography>\n          <Typography variant='subtitle1' color='inherit' noWrap className={classes.sectionTitle}>\n            General\n          </Typography>\n          <Paper square className={classes.section}>\n            <Grid container spacing={0}>\n              <Grid item xs={6}>\n                <Typography variant='subtitle1' color='inherit' noWrap>\n                  PSS endpoint (WebSocket)\n                </Typography>\n              </Grid>\n              <Grid item xs={6}>\n                <TextField\n                  id='pss'\n                  onChange={(e) => this.setState({ pss: e.target.value })}\n                  defaultValue={settings.pss}\n                  disabled={settings.isPssLocked}\n                />\n              </Grid>\n              <Grid item xs={12}>\n                <Typography variant='caption'>\n                  After updating the field you need to restart the app (refresh page)\n                </Typography>\n              </Grid>\n              <Grid item xs={12} className={classes.divider}>\n                <Divider />\n              </Grid>\n              <Grid item xs={6}>\n                <Typography variant='subtitle1' color='inherit' noWrap>\n                  BZZ endpoint\n                </Typography>\n              </Grid>\n              <Grid item xs={6}>\n                <TextField\n                  id='bzz'\n                  onChange={(e) => this.setState({ bzz: e.target.value })}\n                  defaultValue={settings.bzz}\n                />\n              </Grid>\n              <Grid item xs={12}>\n                <Typography variant='caption'>\n                  After updating the field you need to restart the app (refresh page)\n                </Typography>\n              </Grid>\n              <Grid item xs={12} className={classes.divider}>\n                <Divider />\n              </Grid>\n              <Grid item xs={6}>\n                <Typography variant='subtitle1' color='inherit' noWrap>\n                  Local storage\n                </Typography>\n              </Grid>\n              <Grid item xs={6}>\n                {pretty(settings.size)}\n              </Grid>\n            </Grid>\n          </Paper>\n          <Typography variant='subtitle1' color='inherit' noWrap className={classes.sectionTitle}>\n            Security\n          </Typography>\n          <Paper square className={classes.section}>\n            <Grid container spacing={0}>\n              <Grid item xs={6}>\n                <Typography variant='subtitle1' color='inherit' noWrap>\n                  Reveal address partially\n                </Typography>\n              </Grid>\n              <Grid item xs={6}>\n                <TextField\n                  id='revealAddress'\n                  select\n                  onChange={(e) => this.setState({ revealAddress: +e.target.value })}\n                  value={this.state.revealAddress === undefined ? settings.revealAddress : this.state.revealAddress}\n                >\n                  <MenuItem value={0}>Broadcast</MenuItem>\n                  <MenuItem value={4}>4</MenuItem>\n                  <MenuItem value={8}>8</MenuItem>\n                  <MenuItem value={16}>16</MenuItem>\n                  <MenuItem value={32}>Full</MenuItem>\n                </TextField>\n              </Grid>\n            </Grid>\n          </Paper>\n          <Typography variant='subtitle1' color='inherit' noWrap className={classes.sectionTitle}>\n            About\n          </Typography>\n          <Paper square className={classes.section}>\n            <Grid container spacing={0}>\n              <Grid item xs={6}>\n                <Typography variant='subtitle1' color='inherit' noWrap>\n                  Version\n                </Typography>\n              </Grid>\n              <Grid item xs={6}>\n                <a href={`https://github.com/okamilab/nebula/releases/tag/v${packageJson.version}`} target='_block'>\n                  {packageJson.version}\n                </a>\n              </Grid>\n            </Grid>\n          </Paper>\n          <div className={classes.actionBar}>\n            <Button\n              variant='contained'\n              onClick={this.reset}\n              className={classes.button}>\n              Reset\n            </Button>\n            <Button\n              variant='contained'\n              color='primary'\n              onClick={this.save}\n              className={classes.button}>\n              Save\n            </Button>\n          </div>\n        </Grid>\n      </Grid>\n    )\n  }\n\n  reset = () => {\n    this.props.dispatch(resetSettings());\n  };\n\n  save = () => {\n    const { pss, bzz, revealAddress } =\n      Object.assign({}, this.props.settings, this.state);\n    this.props.dispatch(updateSettings({ pss, bzz, revealAddress }));\n  };\n}\n\nSettings.propTypes = {\n  classes: PropTypes.object.isRequired,\n  dispatch: PropTypes.func.isRequired,\n  settings: PropTypes.object.isRequired,\n  app: PropTypes.object.isRequired\n};\n\nexport default compose(\n  connect((state) => {\n    const { settings, app } = state || {\n      settings: {\n        pss: DEFAULT_SETTINGS.pss,\n        bzz: DEFAULT_SETTINGS.bzz,\n        isPssLocked: false,\n        revealAddress: DEFAULT_SETTINGS.revealAddress,\n        size: 0\n      },\n      app: {\n        isConnected: false,\n      }\n    };\n    return { settings, app };\n  }),\n  withStyles(styles)\n)(Settings);","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport { CopyToClipboard } from 'react-copy-to-clipboard';\nimport { withStyles } from '@material-ui/core/styles';\nimport FormControl from '@material-ui/core/FormControl';\nimport IconButton from '@material-ui/core/IconButton';\nimport Input from '@material-ui/core/Input';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport InputAdornment from '@material-ui/core/InputAdornment';\nimport Tooltip from '@material-ui/core/Tooltip';\nimport { FileCopy } from '@material-ui/icons';\n\nconst styles = {\n  input: {\n    '&:before': {\n      borderBottomStyle: 'none!important'\n    }\n  }\n};\n\nclass Key extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      tooltipOpen: false,\n      copied: false\n    };\n\n    this.toggle = this.toggle.bind(this);\n  }\n\n  toggle() {\n    this.setState({\n      tooltipOpen: !this.state.tooltipOpen,\n      copied: this.state.tooltipOpen\n    });\n  }\n\n  render() {\n    const { name, value, label, classes } = this.props;\n\n    if (!value || !value.length) {\n      return null;\n    }\n\n    const display = value.length > 22 ?\n      `${value.substr(0, 16)}...${value.substr(value.length - 4)}` :\n      value;\n    return (\n      <FormControl margin=\"normal\">\n        <InputLabel htmlFor={`${name}_key`}>{label}</InputLabel>\n        <Input\n          id={`${name}_key`}\n          type=\"text\"\n          value={display}\n          disabled\n          className={classes.input}\n          endAdornment={\n            <InputAdornment position=\"end\">\n              <CopyToClipboard\n                id={`${name}_key`}\n                text={value}\n                onCopy={() => this.setState({ copied: true })}>\n                <Tooltip\n                  title={this.state.copied ? 'Copied' : 'Copy to clipboard'}\n                  placement=\"right\"\n                  onClose={() => {\n                    setTimeout(() => this.setState({ copied: false }), 200);\n                  }}>\n                  <IconButton>\n                    <FileCopy fontSize='small' />\n                  </IconButton>\n                </Tooltip>\n              </CopyToClipboard>\n            </InputAdornment>\n          }\n        />\n      </FormControl>\n    )\n  }\n}\n\nKey.propTypes = {\n  classes: PropTypes.object.isRequired,\n  name: PropTypes.string.isRequired,\n  value: PropTypes.string.isRequired,\n  label: PropTypes.string\n};\n\nexport default withStyles(styles)(Key);","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport { compose } from 'redux';\nimport { connect } from 'react-redux';\nimport { withStyles } from '@material-ui/core/styles';\nimport Grid from '@material-ui/core/Grid';\nimport Typography from '@material-ui/core/Typography';\nimport Paper from '@material-ui/core/Paper';\nimport TextField from '@material-ui/core/TextField';\nimport Button from '@material-ui/core/Button';\n\nimport Identicon from './../../base/components/Identicon';\nimport Key from './../../base/components/Key';\nimport { updateUsername } from './../actions';\n\nconst styles = theme => ({\n  sectionTitle: {\n    marginTop: theme.spacing(2),\n  },\n  section: {\n    borderRadius: 5,\n    marginTop: theme.spacing(2),\n    padding: theme.spacing(2)\n  },\n  button: {\n    marginTop: theme.spacing(2)\n  }\n});\n\nclass Profile extends Component {\n  constructor(props) {\n    super(props)\n\n    this.state = {};\n  }\n\n  render() {\n    const { account, classes } = this.props;\n    if (!account) {\n      return <div>Loading</div>\n    }\n\n    const { username, publicKey, overlayAddress } = account;\n    if (!publicKey) {\n      return <div>No data</div>\n    }\n\n    return (\n      <Grid\n        container\n        spacing={0}\n        justify='center'\n        style={{ paddingTop: 10 }}\n      >\n        <Grid item md={6} sm={8} xs={11}>\n          <Typography variant='h5' color='inherit' noWrap className={classes.sectionTitle}>\n            Profile\n          </Typography>\n          <Paper square className={classes.section}>\n            <Grid container spacing={0}>\n              <Grid item xs={3}>\n                {\n                  publicKey ?\n                    <Identicon publicKey={publicKey} size={78} /> :\n                    null\n                }\n              </Grid>\n              <Grid item xs={6}>\n                <TextField\n                  id='username'\n                  label='User name'\n                  onChange={(e) => this.setState({ username: e.target.value })}\n                  defaultValue={username}\n                />\n              </Grid>\n              <Grid item xs={3}>\n                <Button\n                  variant='contained'\n                  color='primary'\n                  onClick={this.save}\n                  className={classes.button}\n                  disabled={!this.state.username}>\n                  Save\n                </Button>\n              </Grid>\n              <Grid item xs={3}></Grid>\n              <Grid item xs={9}>\n                <Key\n                  name='publicKey'\n                  value={publicKey}\n                  label='Public key' />\n              </Grid>\n              <Grid item xs={3}></Grid>\n              <Grid item xs={9}>\n                <Key\n                  name='overlayAddress'\n                  value={overlayAddress}\n                  label='Overlay address' />\n              </Grid>\n            </Grid>\n          </Paper>\n        </Grid>\n      </Grid>\n    );\n  }\n\n  save = async () => {\n    const { username } =\n      Object.assign({}, this.props, this.state);\n    await this.props.dispatch(updateUsername(username));\n  };\n}\n\nProfile.propTypes = {\n  classes: PropTypes.object.isRequired,\n  dispatch: PropTypes.func.isRequired,\n  account: PropTypes.object,\n};\n\nexport default compose(\n  connect((state) => {\n    const { account } = state || {\n      account: {\n        publicKey: '',\n        username: ''\n      }\n    };\n    return { account };\n  }),\n  withStyles(styles)\n)(Profile);","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport withStyles from '@material-ui/core/styles/withStyles';\nimport Typography from '@material-ui/core/Typography';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport ListSubheader from '@material-ui/core/ListSubheader';\n\nconst styles = _ => ({\n});\n\nclass ContactListGroup extends Component {\n  render() {\n    const { list, title, renderItem } = this.props;\n    if (!list || !list.length) {\n      return null;\n    }\n\n    const items = list.map(renderItem);\n    return (\n      <List subheader={<ListSubheader>{title}</ListSubheader>}>\n        {items}\n      </List>\n    );\n  }\n}\n\nContactListGroup.defaultProps = {\n  renderItem: (c, i) =>\n    <ListItem key={i} button>\n      <ListItemText\n        disableTypography\n        primary={\n          <Typography color='inherit' noWrap>\n            {c.key}\n          </Typography>\n        } />\n    </ListItem>\n};\n\n\nContactListGroup.propTypes = {\n  classes: PropTypes.object.isRequired,\n  renderItem: PropTypes.func.isRequired,\n  list: PropTypes.array,\n  title: PropTypes.string\n};\n\nexport default withStyles(styles)(ContactListGroup);","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport { compose } from 'redux';\nimport { connect } from 'react-redux';\nimport Button from '@material-ui/core/Button';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogContentText from '@material-ui/core/DialogContentText';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport Typography from '@material-ui/core/Typography';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemText from '@material-ui/core/ListItemText';\n\nimport { acceptContact, declineContact } from './../actions';\n\nclass ContactRequest extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      modal: false\n    };\n\n    this.toggle = this.toggle.bind(this);\n  }\n\n  toggle() {\n    this.setState({\n      modal: !this.state.modal\n    });\n  }\n\n  render() {\n    const { publicKey } = this.props;\n\n    return (\n      <ListItem button onClick={this.toggle}>\n        <ListItemText\n          disableTypography\n          primary={\n            <Typography color='inherit' noWrap>\n              {publicKey}\n            </Typography>\n          } />\n        <Dialog\n          open={this.state.modal}\n          onClose={this.toggle}\n          aria-labelledby=\"form-dialog-title\"\n        >\n          <DialogTitle id=\"form-dialog-title\">Received contact</DialogTitle>\n          <DialogContent>\n            <DialogContentText component=\"div\">\n              <Typography noWrap>\n                Do you want to accept request from {publicKey}?\n              </Typography>\n            </DialogContentText>\n          </DialogContent>\n          <DialogActions>\n            <Button onClick={this.decline} color=\"default\">\n              Decline\n            </Button>\n            <Button\n              onClick={this.accept}\n              variant=\"contained\"\n              color=\"primary\">\n              Accept\n            </Button>\n          </DialogActions>\n        </Dialog>\n      </ListItem>\n    );\n  }\n\n  accept = () => {\n    const { publicKey, address, dispatch } = this.props;\n    dispatch(acceptContact(publicKey, address));\n    this.toggle();\n  };\n\n  decline = () => {\n    const { publicKey, address, dispatch } = this.props;\n    dispatch(declineContact(publicKey, address));\n    this.toggle();\n  };\n}\n\nContactRequest.propTypes = {\n  dispatch: PropTypes.func.isRequired,\n  publicKey: PropTypes.string.isRequired,\n  address: PropTypes.string\n};\n\nexport default compose(connect())(ContactRequest);","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport { compose } from 'redux';\nimport { connect } from 'react-redux';\nimport { withStyles } from '@material-ui/core/styles';\nimport Typography from '@material-ui/core/Typography';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport sum from 'hash-sum';\nimport { push } from 'connected-react-router';\n\nimport ContactListGroup from './ContactListGroup';\nimport ContactRequest from './ContactRequest';\nimport Identicon from './../../../base/components/Identicon';\nimport { groupBy } from './../../../base/fn';\n\nconst styles = _ => ({\n});\n\nclass ContactList extends Component {\n  render() {\n    const { contacts, dispatch } = this.props;\n    const map = groupBy(Object.values(contacts), 'type');\n\n    return (\n      <>\n        <ContactListGroup list={map['sent_request']} title='Sent' />\n        <ContactListGroup\n          list={map['received_request']}\n          title='Received'\n          renderItem={(c, i) => <ContactRequest key={i} publicKey={c.key} address={c.address} />} />\n        <ContactListGroup\n          list={map['added']}\n          title='Contacts'\n          renderItem={(c, i) =>\n            <ListItem key={i} button\n              onClick={() => { dispatch(push(`/messenger/contact/${sum(c.key)}`)) }}>\n              <ListItemIcon>\n                <Identicon publicKey={c.key} size={32} />\n              </ListItemIcon>\n              <ListItemText\n                disableTypography\n                primary={\n                  <Typography color='inherit' noWrap>\n                    {c.username || c.key}\n                  </Typography>\n                } />\n            </ListItem>\n          }>\n        </ContactListGroup>\n      </>\n    );\n  }\n}\n\nContactList.propTypes = {\n  classes: PropTypes.object.isRequired,\n  dispatch: PropTypes.func.isRequired,\n  contacts: PropTypes.object,\n};\n\nexport default compose(\n  connect((state) => {\n    const { contacts } = state || {};\n    return { contacts };\n  }),\n  withStyles(styles)\n)(ContactList);","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport { compose } from 'redux';\nimport { connect } from 'react-redux';\nimport { withStyles } from '@material-ui/core/styles';\nimport Button from '@material-ui/core/Button';\nimport TextField from '@material-ui/core/TextField';\nimport MuiExpansionPanel from '@material-ui/core/ExpansionPanel';\nimport MuiExpansionPanelSummary from '@material-ui/core/ExpansionPanelSummary';\nimport MuiExpansionPanelDetails from '@material-ui/core/ExpansionPanelDetails';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogContentText from '@material-ui/core/DialogContentText';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport SnackbarContent from '@material-ui/core/SnackbarContent';\nimport IconButton from '@material-ui/core/IconButton';\nimport { Add, ExpandMore } from '@material-ui/icons';\nimport CircularProgress from '@material-ui/core/CircularProgress';\n\nimport { inviteContact } from './../actions';\n\nconst ExpansionPanel = withStyles({\n  root: {\n    border: 'none',\n    boxShadow: 'none',\n    '&:not(:last-child)': {\n      borderBottom: 0,\n    },\n    '&:before': {\n      display: 'none',\n    },\n    '&$expanded': {\n      margin: 'auto',\n    },\n  },\n  expanded: {},\n})(MuiExpansionPanel);\n\nconst ExpansionPanelSummary = withStyles({\n  root: {\n    padding: 0,\n    minHeight: 56,\n    '&$expanded': {\n      minHeight: 56,\n    },\n  },\n  content: {\n    margin: '10px 0 20px',\n    position: 'relative',\n    '&::after': {\n      content: \"''\",\n      position: 'absolute',\n      bottom: 0,\n      left: 0,\n      right: 0,\n      height: '0.5em',\n      borderTop: '1px solid #ddd'\n    },\n    '&$expanded': {\n      margin: '12px 0',\n    }\n  },\n  expanded: {},\n})(MuiExpansionPanelSummary);\n\nconst ExpansionPanelDetails = withStyles(theme => ({\n  root: {\n    padding: 0,\n  },\n}))(MuiExpansionPanelDetails);\n\nconst styles = theme => ({\n  error: {\n    backgroundColor: theme.palette.error.dark\n  },\n  title: {\n    padding: '0 10px',\n    color: '#bbb',\n    fontSize: '14px',\n    background: '#fff',\n    zIndex: 10\n  }\n});\n\nclass ContactInvite extends Component {\n  static propTypes = {\n    dispatch: PropTypes.func.isRequired,\n  };\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      modal: false,\n      publicKey: '',\n      address: '',\n      error: '',\n      isInvitiong: false\n    };\n\n    this.toggle = this.toggle.bind(this);\n    this.onKeyPress = this.onKeyPress.bind(this);\n  }\n\n  toggle(e) {\n    if (e) {\n      e.stopPropagation();\n    }\n\n    this.setState({\n      error: null,\n      modal: !this.state.modal,\n      isInviting: false\n    });\n  }\n\n  onKeyPress(e) {\n    if (e.key === 'Enter' && this.state.publicKey) {\n      this.invite();\n    }\n  }\n\n  render() {\n    const { classes } = this.props;\n    const { error, isInviting } = this.state;\n\n    return (\n      <>\n        <IconButton color=\"inherit\" onClick={this.toggle}>\n          <Add />\n        </IconButton>\n        <Dialog\n          open={this.state.modal}\n          onClose={this.toggle}\n          aria-labelledby=\"form-dialog-title\"\n          fullWidth={true}\n          maxWidth={'sm'}\n          onClick={e => e.stopPropagation()}\n        >\n          <DialogTitle id=\"form-dialog-title\">Invite contact</DialogTitle>\n          <DialogContent>\n            <DialogContentText component=\"div\">\n              {error ?\n                <SnackbarContent\n                  message={error.message || error}\n                  className={classes.error}></SnackbarContent>\n                : null}\n            </DialogContentText>\n            <TextField\n              autoFocus\n              margin=\"dense\"\n              label=\"Public key or Address or ENS *\"\n              type=\"text\"\n              fullWidth\n              onChange={(e) => this.setState({ publicKey: e.target.value })}\n              onKeyPress={this.onKeyPress}\n            />\n            <ExpansionPanel>\n              <ExpansionPanelSummary expandIcon={<ExpandMore />}>\n                <span className={classes.title}>\n                  Advanced\n                </span>\n              </ExpansionPanelSummary>\n              <ExpansionPanelDetails>\n                <TextField\n                  margin=\"dense\"\n                  label=\"Overlay address\"\n                  type=\"text\"\n                  fullWidth\n                  onChange={(e) => this.setState({ address: e.target.value })}\n                  onKeyPress={this.onKeyPress}\n                />\n              </ExpansionPanelDetails>\n            </ExpansionPanel>\n          </DialogContent>\n          <DialogActions>\n            <Button onClick={this.toggle} color=\"default\">\n              Cancel\n            </Button>\n            <Button\n              onClick={this.invite}\n              disabled={!this.state.publicKey || isInviting}\n              variant=\"contained\"\n              color=\"primary\">\n              Send request\n            </Button>\n            {isInviting && <CircularProgress size={24} />}\n          </DialogActions>\n        </Dialog>\n      </>\n    );\n  }\n\n  invite = async () => {\n    try {\n      const { publicKey, address } = this.state\n      this.setState({ error: null, isInviting: true });\n      await this.props.dispatch(inviteContact(publicKey, address));\n    } catch (error) {\n      this.setState({ error: error.message, isInviting: false });\n      return;\n    }\n\n    this.toggle();\n  };\n}\n\nContactInvite.propTypes = {\n  classes: PropTypes.object.isRequired\n};\n\nexport default compose(\n  connect(),\n  withStyles(styles)\n)(ContactInvite);","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport { compose } from 'redux';\nimport { connect } from 'react-redux';\nimport withStyles from '@material-ui/core/styles/withStyles';\nimport Typography from '@material-ui/core/Typography';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport { push } from 'connected-react-router';\nimport sum from 'hash-sum';\n\nimport Identicon from './../../../base/components/Identicon';\n\nconst styles = _ => ({\n});\n\nclass ChatList extends Component {\n  render() {\n    const { chats, dispatch } = this.props;\n\n    return (\n      <List component=\"div\" disablePadding>\n        {\n          Object.values(chats).map((c, i) =>\n            <ListItem key={i} button\n              onClick={() => { dispatch(push(`/messenger/chat/${sum(c.key)}`)) }}>\n              <ListItemIcon>\n                <Identicon publicKey={c.key} size={32} />\n              </ListItemIcon>\n              <ListItemText\n                disableTypography\n                primary={\n                  <Typography color='inherit' noWrap>\n                    {c.key}\n                  </Typography>\n                } />\n            </ListItem>\n          )\n        }\n      </List>\n    );\n  }\n}\n\nChatList.propTypes = {\n  classes: PropTypes.object.isRequired,\n  dispatch: PropTypes.func.isRequired,\n  chats: PropTypes.object,\n};\n\nexport default compose(\n  connect((state) => {\n    const { chats } = state || {};\n    return { chats };\n  }),\n  withStyles(styles)\n)(ChatList);","import React, { Component } from 'react';\nimport { withStyles } from '@material-ui/core/styles';\nimport { Contacts, Chat, ExpandLess, ExpandMore } from '@material-ui/icons';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport ListItemSecondaryAction from '@material-ui/core/ListItemSecondaryAction';\nimport Collapse from '@material-ui/core/Collapse';\nimport MuiIconButton from '@material-ui/core/IconButton';\n\nimport ContactList from './../contacts/components/ContactList';\nimport ContactInvite from './../contacts/components/ContactInvite';\nimport ChatList from './../chats/components/ChatList';\n\nconst IconButton = withStyles({\n  root: {\n    transition: 'none',\n    '&:hover': {\n      backgroundColor: 'transparent',\n    },\n  }\n})(MuiIconButton);\n\nclass ControlPanel extends Component {\n  state = {\n    isContactsOpen: true,\n    isChatsOpen: true,\n  };\n\n  render() {\n    return (\n      <List component=\"nav\">\n        <ListItem\n          button\n          onClick={() => { this.setState({ isContactsOpen: !this.state.isContactsOpen }) }}>\n          <ListItemIcon>\n            <Contacts />\n          </ListItemIcon>\n          <ListItemText primary=\"Contacts\" />\n          <ListItemSecondaryAction>\n            <ContactInvite />\n            <IconButton\n              edge=\"end\"\n              size=\"small\"\n              onClick={() => { this.setState({ isContactsOpen: !this.state.isContactsOpen }) }}>\n              {this.state.isContactsOpen ? <ExpandLess /> : <ExpandMore />}\n            </IconButton>\n          </ListItemSecondaryAction>\n        </ListItem>\n        <Collapse in={this.state.isContactsOpen}>\n          <ContactList />\n        </Collapse>\n        <ListItem button onClick={() => { this.setState({ isChatsOpen: !this.state.isChatsOpen }) }}>\n          <ListItemIcon>\n            <Chat />\n          </ListItemIcon>\n          <ListItemText primary=\"Chats\" />\n          <ListItemSecondaryAction>\n            <IconButton\n              edge=\"end\"\n              size=\"small\"\n              onClick={() => { this.setState({ isChatsOpen: !this.state.isChatsOpen }) }}>\n              {this.state.isChatsOpen ? <ExpandLess /> : <ExpandMore />}\n            </IconButton>\n          </ListItemSecondaryAction>\n        </ListItem>\n        <Collapse in={this.state.isChatsOpen}>\n          <ChatList />\n        </Collapse>\n      </List>\n    );\n  }\n}\n\nexport default ControlPanel;","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { withStyles } from '@material-ui/core/styles';\nimport Paper from '@material-ui/core/Paper';\n\nimport ControlPanel from './ControlPanel';\n\nconst styles = {\n  root: {\n    flexGrow: 1,\n    maxWidth: 500,\n    height: '100%'\n  },\n};\n\nfunction LeftSide({ classes }) {\n  return (\n    <Paper square className={classes.root}>\n      <ControlPanel />\n    </Paper>\n  );\n}\n\nLeftSide.propTypes = {\n  classes: PropTypes.object.isRequired\n};\n\nexport default withStyles(styles)(LeftSide);","import React from 'react';\nimport PropTypes from 'prop-types';\nimport withStyles from '@material-ui/core/styles/withStyles';\nimport Grid from '@material-ui/core/Grid';\n\nimport LeftSide from './LeftSide';\n\nconst styles = {\n  container: {\n    width: '100%',\n    height: '100%',\n    margin: 0,\n    padding: 0\n  },\n  cell: {\n    margin: 0,\n    padding: 0,\n    height: '100%'\n  }\n};\n\nfunction Layout({ classes, children, isNarrow }) {\n  return (\n    <Grid container spacing={0} className={classes.container}>\n      {\n        !isNarrow && <Grid item xs={3} className={classes.cell}>\n          <LeftSide />\n        </Grid>\n      }\n      <Grid item xs={isNarrow ? 12 : 9} className={classes.cell}>\n        {children}\n      </Grid>\n    </Grid>\n  );\n}\n\nLayout.propTypes = {\n  classes: PropTypes.object.isRequired,\n  children: PropTypes.node,\n  isNarrow: PropTypes.bool\n};\n\nexport default withStyles(styles)(Layout);","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport { compose } from 'redux';\nimport { connect } from 'react-redux';\nimport { withStyles } from '@material-ui/core/styles';\nimport Grid from '@material-ui/core/Grid';\nimport Typography from '@material-ui/core/Typography';\nimport Paper from '@material-ui/core/Paper';\nimport TextField from '@material-ui/core/TextField';\nimport Button from '@material-ui/core/Button';\nimport { push } from 'connected-react-router';\nimport sum from 'hash-sum';\n\nimport Layout from './../../components/Layout';\nimport Identicon from './../../../base/components/Identicon';\nimport Key from './../../../base/components/Key';\n\nconst styles = theme => ({\n  sectionTitle: {\n    marginTop: theme.spacing(2),\n  },\n  section: {\n    borderRadius: 5,\n    marginTop: theme.spacing(2),\n    padding: theme.spacing(2)\n  },\n  actionBar: {\n    paddingTop: theme.spacing(2)\n  },\n  button: {\n    marginRight: theme.spacing(2),\n  },\n});\n\nclass Contact extends Component {\n  render() {\n    const { classes, isNarrow, contact, dispatch } = this.props;\n    if (!contact) {\n      return <div>Contact not found</div>\n    }\n\n    const { username, key, address } = contact;\n    if (!key) {\n      return <div>No data</div>\n    }\n\n    return (\n      <Layout isNarrow={isNarrow}>\n        <Grid\n          container\n          spacing={0}\n          justify='center'\n          style={{ paddingTop: 10 }}\n        >\n          <Grid item md={6} sm={8} xs={11}>\n            <Typography variant='h5' color='inherit' noWrap className={classes.sectionTitle}>\n              Contact\n            </Typography>\n            <Paper square className={classes.section}>\n              <Grid container spacing={0}>\n                <Grid item xs={3}>\n                  {key ? <Identicon publicKey={key} size={78} /> : null}\n                </Grid>\n                <Grid item xs={9}>\n                  <TextField\n                    id='username'\n                    label='User name'\n                    disabled\n                    defaultValue={username}\n                  />\n                </Grid>\n                <Grid item xs={3}></Grid>\n                <Grid item xs={9}>\n                  <Key\n                    name='publicKey'\n                    value={key}\n                    label='Public key' />\n                </Grid>\n                <Grid item xs={3}></Grid>\n                <Grid item xs={9}>\n                  <Key\n                    name='address'\n                    value={address}\n                    label='Overlay address' />\n                </Grid>\n              </Grid>\n            </Paper>\n            <div className={classes.actionBar}>\n              <Button\n                variant='contained'\n                color='primary'\n                className={classes.button}\n                onClick={() => { dispatch(push(`/messenger/chat/${sum(key)}`)) }}>\n                Chat\n              </Button>\n            </div>\n          </Grid>\n        </Grid>\n      </Layout>\n    );\n  }\n}\n\nContact.propTypes = {\n  classes: PropTypes.object.isRequired,\n  dispatch: PropTypes.func.isRequired,\n  isNarrow: PropTypes.bool,\n  contact: PropTypes.object\n};\n\nexport default compose(\n  connect((state, props) => {\n    const { contacts } = state || {};\n    return { contact: contacts[props.match.params.key] };\n  }),\n  withStyles(styles)\n)(Contact);","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { withStyles } from '@material-ui/core/styles';\n\nconst styles = theme => ({\n  divider: {\n    textAlign: 'center',\n    borderBottom: '1px solid #ddd',\n    lineHeight: '0.3em',\n    margin: '10px 0 20px'\n  },\n  title: {\n    background: theme.palette.background.default,\n    padding: '0 6px',\n    color: '#bbb',\n    fontSize: '12px'\n  }\n});\n\nconst ChatDayDivider = ({ classes, date }) => {\n  return (\n    <div className={classes.divider}>\n      <span className={classes.title}>\n        {date.toLocaleDateString()}\n        </span>\n    </div>\n  );\n}\n\nChatDayDivider.propTypes = {\n  classes: PropTypes.object.isRequired,\n  date: PropTypes.instanceOf(Date).isRequired,\n}\n\nexport default withStyles(styles)(ChatDayDivider);","import React, { Component, Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { compose } from 'redux';\nimport { connect } from 'react-redux';\nimport { withStyles } from '@material-ui/core/styles';\nimport Button from '@material-ui/core/Button';\nimport Emoji from 'react-emoji-render';\n\nimport Identicon from './../../../base/components/Identicon';\nimport { download } from './../actions';\n\nconst styles = theme => ({\n  file: {\n    backgroundColor: '#f1f1f4',\n    display: 'inline-block',\n    padding: 10,\n    borderRadius: 6\n  },\n  fileName: {\n    paddingTop: theme.spacing(1)\n  },\n  divider: {\n    marginTop: theme.spacing(1),\n    marginBottom: theme.spacing(1),\n  },\n  actionBar: {\n    textAlign: 'center',\n    paddingBottom: theme.spacing(1)\n  },\n  block: {\n    textAlign: 'left',\n    paddingTop: 2\n  },\n  owned: {\n    textAlign: 'right',\n    paddingRight: 10\n  },\n  layout: {\n    display: 'flex'\n  },\n  content: {\n    paddingLeft: theme.spacing(1)\n  },\n  header: {\n    fontSize: 12,\n    color: '#bbb'\n  },\n  body: {\n    backgroundColor: '#f2f6f9',\n    display: 'inline-block',\n    padding: '2px 10px',\n    marginRight: 10,\n    borderRadius: 6,\n    textAlign: 'left'\n  },\n  ownedBody: {\n    backgroundColor: '#dbf4fd',\n    marginRight: 0,\n    marginLeft: 40\n  }\n});\n\nclass ChatMessage extends Component {\n  renderMessageContent() {\n    const { classes, message, isOwn } = this.props;\n    const { text } = message;\n\n    switch (text.startsWith('bzz:/')) {\n      case true:\n        return (\n          <div className={classes.file}>\n            <div className={classes.fileName}>File: {text.substr(5, 15)}...</div>\n            <hr className={classes.divider} />\n            <div className={classes.actionBar}>\n              <Button onClick={() => this.download(text.substr(5))}>\n                Download\n              </Button>\n            </div>\n          </div>\n        );\n      default:\n        return (\n          <div className={`${classes.body} ${isOwn ? classes.ownedBody : null}`}>\n            <Emoji svg='true' text={message.text} />\n          </div>\n        );\n    }\n  }\n\n  renderMessage() {\n    const { classes, message, sender, isOwn, showHeader } = this.props;\n    const time = new Date(message.timestamp);\n    let header;\n\n    switch (isOwn) {\n      case true:\n        if (showHeader) {\n          header = (\n            <div className={classes.header}>\n              {time.toLocaleTimeString()}\n            </div>\n          );\n        }\n        return (\n          <Fragment>\n            {header}\n            {this.renderMessageContent()}\n          </Fragment>\n        );\n      default:\n        let identicon = (<div style={{ width: 32 }}></div>);\n        const { key, username } = sender;\n        if (showHeader) {\n          identicon = (\n            <div>\n              <Identicon publicKey={key} size={32} />\n            </div>\n          );\n          header = (\n            <div className={classes.header}>\n              {username || `${key.substr(0, 8)}...`}, {time.toLocaleTimeString()}\n            </div>\n          );\n        }\n        return (\n          <div className={classes.layout}>\n            {identicon}\n            <div className={classes.content}>\n              {header}\n              {this.renderMessageContent()}\n            </div>\n          </div>\n        );\n    }\n  }\n\n  render() {\n    const { classes, isOwn } = this.props;\n\n    return (\n      <div className={`${classes.block} ${isOwn ? classes.owned : null}`}>\n        {this.renderMessage()}\n      </div>\n    );\n  }\n\n  download = (hash) => {\n    if (!hash) {\n      return;\n    }\n\n    this.props.dispatch(download(hash));\n  }\n}\n\nChatMessage.propTypes = {\n  classes: PropTypes.object.isRequired,\n  dispatch: PropTypes.func.isRequired,\n  message: PropTypes.object.isRequired,\n  sender: PropTypes.object.isRequired,\n  isOwn: PropTypes.bool.isRequired,\n  showHeader: PropTypes.bool.isRequired,\n};\n\nexport default compose(\n  connect(),\n  withStyles(styles)\n)(ChatMessage);","import React, { Component, Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { compose } from 'redux';\nimport { connect } from 'react-redux';\nimport { Element, scroller } from 'react-scroll';\nimport { withStyles } from '@material-ui/core/styles';\nimport Grid from '@material-ui/core/Grid';\nimport Paper from '@material-ui/core/Paper';\nimport InputBase from '@material-ui/core/InputBase';\nimport IconButton from '@material-ui/core/IconButton';\nimport MuiMenu from '@material-ui/core/Menu';\nimport { Send, Mood } from '@material-ui/icons';\nimport sum from 'hash-sum';\nimport 'emoji-mart/css/emoji-mart.css'\nimport { Picker } from 'emoji-mart'\n\nimport Layout from './../../components/Layout';\nimport ChatDayDivider from './../components/ChatDayDivider';\nimport ChatMessage from './../components/ChatMessage';\nimport { sendMessage, sendFile } from './../actions';\n\nconst Menu = withStyles({\n  list: {\n    padding: 0\n  }\n})(MuiMenu);\n\nconst styles = theme => ({\n  scrollContainer: {\n    height: '100%',\n    overflow: 'scroll'\n  },\n  list: {\n    paddingBottom: 80\n  },\n  root: {\n    marginTop: theme.spacing(4),\n    marginBottom: theme.spacing(4),\n    marginRight: theme.spacing(2),\n    padding: '2px 4px',\n    display: 'flex'\n  },\n  input: {\n    marginLeft: 8,\n    flex: 1,\n  },\n  file: {\n    width: 0.1,\n    height: 0.1,\n    opacity: 0,\n    overflow: 'hidden',\n    position: 'absolute',\n    zIndex: '-1',\n    cursor: 'pointer',\n  },\n  fileLabel: {\n    margin: 0,\n  },\n  iconButton: {\n    padding: 10,\n  },\n  divider: {\n    width: 1,\n    height: 28,\n    marginTop: 8,\n    marginBottom: 8,\n    marginLeft: 4,\n    marginRight: 4,\n  },\n  fixed: {\n    position: 'fixed',\n    left: 0,\n    right: 0,\n    bottom: 0,\n  }\n});\n\nclass Chat extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      msg: '',\n      anchorEP: null,\n      isOpenEP: false\n    };\n\n    this.onChange = this.onChange.bind(this);\n    this.onKeyPress = this.onKeyPress.bind(this);\n    this.showEP = this.showEP.bind(this);\n    this.hideEP = this.hideEP.bind(this);\n    this.addEmoji = this.addEmoji.bind(this);\n  }\n\n  componentDidMount() {\n    this.scrollToBottom();\n  }\n\n  componentDidUpdate() {\n    this.scrollToBottom();\n  }\n\n  scrollToBottom() {\n    scroller.scrollTo('bottom', {\n      duration: 400,\n      delay: 0,\n      smooth: 'easeInOutQuart',\n      containerId: 'scroll-container'\n    });\n  }\n\n  onChange(e) {\n    this.setState({\n      msg: e.target.value\n    });\n  }\n\n  onKeyPress(e) {\n    if (e.key === 'Enter' && this.state.msg) {\n      this.send();\n    }\n  }\n\n  isSameDay(curTime, prevTime) {\n    return curTime.getDay() === prevTime.getDay();\n  }\n\n  showMsgHeader(index, curMsg, prevMsg) {\n    if (index === 0) {\n      return true;\n    }\n\n    if (curMsg.sender !== prevMsg.sender) {\n      return true;\n    }\n\n    return false;\n  }\n\n  getParticipants() {\n    const { chat, account, contacts } = this.props;\n    const { publicKey } = account;\n\n    const participants = {\n      [sum(publicKey)]: { key: publicKey }\n    };\n\n    Object.keys(chat.participants)\n      .forEach(k => {\n        const contact = contacts[k];\n        if (!contact) {\n          return;\n        }\n        participants[k] = contacts[k];\n      });\n\n    return participants;\n  }\n\n  showEP = event => {\n    this.setState({ anchorEP: event.currentTarget });\n  };\n\n  hideEP = () => {\n    this.setState({ anchorEP: null });\n  };\n\n  addEmoji = (emoji) => {\n    this.setState({\n      msg: this.state.msg.length ?\n        this.state.msg + ' ' + emoji.native :\n        emoji.native,\n      anchorEP: null\n    });\n  };\n\n  render() {\n    const { classes, isNarrow, chat, account } = this.props;\n    if (!chat) {\n      return <div>Chat not found</div>\n    }\n\n    const participants = this.getParticipants();\n    const messages = Object.values(chat.messages)\n      .sort((a, b) => a.timestamp - b.timestamp);\n    const { publicKey } = account;\n\n    const { msg, anchorEP } = this.state;\n    const isOpenEP = Boolean(anchorEP);\n    return (\n      <>\n        <Layout isNarrow={isNarrow}>\n          <Element id='scroll-container' className={classes.scrollContainer}>\n            <Grid\n              container\n              spacing={0}\n              justify='center'\n            >\n              <Grid item xs={10} lg={10} xl={8} className={classes.list}>\n                {\n                  messages\n                    .map((m, i) => {\n                      const sender = participants[m.sender];\n                      const date = new Date(m.timestamp);\n                      const showDayDivider = i === 0 || !this.isSameDay(date, new Date(messages[i - 1].timestamp));\n                      return (\n                        <Fragment key={i}>\n                          {showDayDivider ? <ChatDayDivider date={date} /> : null}\n                          <div>\n                            <ChatMessage\n                              message={m}\n                              sender={sender}\n                              isOwn={sender.key === publicKey}\n                              showHeader={this.showMsgHeader(i, m, i > 0 ? messages[i - 1] : null) || showDayDivider} />\n                          </div>\n                        </Fragment>\n                      )\n                    })\n                }\n                <Element name='bottom'></Element>\n              </Grid>\n            </Grid>\n          </Element>\n        </Layout>\n        <div className={classes.fixed}>\n          <Grid container spacing={0}>\n            {\n              !isNarrow && <Grid item sm={3}></Grid>\n            }\n            <Grid item xs={isNarrow ? 12 : 9}>\n              <Grid\n                container\n                spacing={0}\n                justify='center'\n              >\n                <Grid item xs={10} lg={10} xl={8}>\n                  <Paper className={classes.root} elevation={1}>\n                    <InputBase\n                      className={classes.input}\n                      placeholder='Type a message here'\n                      value={this.state.msg}\n                      onChange={this.onChange}\n                      onKeyPress={this.onKeyPress}\n                      autoFocus />\n                    {/* <input\n                      type='file'\n                      name='file'\n                      id='file'\n                      className={classes.file}\n                      onChange={this.upload}\n                    />\n                    <label htmlFor='file' className={classes.fileLabel}>\n                      <IconButton className={classes.iconButton} component='span'>\n                        <Description />\n                      </IconButton>\n                    </label>\n                    <Divider className={classes.divider} /> */}\n                    <IconButton\n                      aria-owns={isOpenEP ? 'emoji-picker' : undefined}\n                      aria-haspopup='true'\n                      onClick={this.showEP}\n                      className={classes.iconButton}>\n                      <Mood />\n                    </IconButton>\n                    <IconButton\n                      className={classes.iconButton}\n                      onClick={this.send}\n                      disabled={!msg}>\n                      <Send />\n                    </IconButton>\n                  </Paper>\n                </Grid>\n              </Grid>\n            </Grid>\n          </Grid>\n          <Menu\n            id='emoji-picker'\n            anchorEl={anchorEP}\n            anchorOrigin={{\n              vertical: 'top',\n              horizontal: 'right',\n            }}\n            transformOrigin={{\n              vertical: 'top',\n              horizontal: 'right',\n            }}\n            open={isOpenEP}\n            onClose={this.hideEP}\n            keepMounted\n          >\n            <Picker onSelect={this.addEmoji} native={true} />\n          </Menu>\n        </div>\n      </>\n    );\n  }\n\n  send = () => {\n    const { id } = this.props;\n    this.props.dispatch(sendMessage(id, this.state.msg));\n    this.setState({ msg: '' });\n  };\n\n  upload = (e) => {\n    if (!e.target.files.length) {\n      return;\n    }\n\n    const { id } = this.props;\n    this.props.dispatch(sendFile(id, e.target.files[0]));\n  }\n}\n\nChat.propTypes = {\n  classes: PropTypes.object.isRequired,\n  dispatch: PropTypes.func.isRequired,\n  isNarrow: PropTypes.bool,\n  id: PropTypes.string,\n  chat: PropTypes.object,\n  account: PropTypes.object,\n};\n\nexport default compose(\n  connect((state, props) => {\n    const { chats, account, contacts } = state || {\n      chats: [],\n      account: {},\n      contacts: {}\n    };\n    const hash = props.match.params.key;\n    return {\n      id: hash,\n      chat: chats[hash],\n      account,\n      contacts\n    };\n  }),\n  withStyles(styles)\n)(Chat);","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { connect } from 'react-redux';\n\nimport { connect as connectApp } from '../../app/actions';\n\nclass Startup extends React.Component {\n  static propTypes = {\n    dispatch: PropTypes.func.isRequired,\n    children: PropTypes.node\n  };\n\n  componentDidMount() {\n    const { dispatch } = this.props;\n    dispatch(connectApp());\n  }\n\n  render() {\n    return (\n      <>\n        {this.props.children}\n      </>\n    );\n  }\n}\n\nexport default connect()(Startup)","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { compose } from 'redux';\nimport { connect } from 'react-redux';\nimport { Switch, Route } from 'react-router';\nimport Helmet from 'react-helmet-async';\nimport { useTheme } from '@material-ui/core/styles';\nimport useMediaQuery from '@material-ui/core/useMediaQuery';\n\nimport Layout from './base/containers/Layout';\n// import Home from './base/pages/Home';\nimport Settings from './settings/pages/Settings';\nimport Profile from './account/pages/Profile';\nimport Messenger from './messenger';\nimport Contact from './messenger/contacts/pages/Contact';\nimport Chat from './messenger/chats/pages/Chat';\nimport ControlPanel from './messenger/components/ControlPanel';\n\nimport Startup from './base/containers/Startup';\nimport './App.css';\n\nfunction App({ settings }) {\n  const theme = useTheme();\n  const isNarrow = !useMediaQuery(theme.breakpoints.up('md')) || settings.mode === 'narrow';\n\n  return (\n    <Startup>\n      <Helmet titleTemplate='Nebula - %s' />\n      <Layout isNarrow={isNarrow}>\n        <Switch>\n          {/* <Route exact path={settings.home} component={Home} /> */}\n          <Route exact path='/settings' component={Settings} />\n          <Route exact path='/profile' component={Profile} />\n          {/* <Route exact path='/messenger' render={(props) => (<Messenger {...props} isNarrow={isNarrow} />)} /> */}\n          <Route exact path='/' render={(props) => (<Messenger {...props} isNarrow={isNarrow} />)} />\n          <Route exact path='/messenger/contact/:key' render={(props) => (<Contact {...props} isNarrow={isNarrow} />)} />\n          <Route exact path='/messenger/chat/:key' render={(props) => (<Chat {...props} isNarrow={isNarrow} />)} />\n          <Route exact path='/messenger/control' render={(props) => (<ControlPanel {...props} isNarrow={isNarrow} />)} />\n        </Switch>\n      </Layout>\n    </Startup>\n  );\n}\n\nApp.propTypes = {\n  settings: PropTypes.object.isRequired,\n};\n\nexport default compose(\n  connect((state) => {\n    const { settings } = state || {\n      settings: {\n        mode: 'full',\n        home: '/'\n      }\n    };\n    return { settings };\n  })\n)(App);","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit http://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See http://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport dotenv from 'dotenv';\nimport { AppContainer } from 'react-hot-loader';\nimport { HelmetProvider } from 'react-helmet-async';\nimport { Provider } from 'react-redux';\nimport { ConnectedRouter } from 'connected-react-router';\n\nimport './index.css';\nimport { createHttpClient } from './base/httpClient';\nimport { configureStore, history } from './base/redux';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\nimport { run as apiRun } from './api';\n\ndotenv.config();\n\nconst urlParams = new URLSearchParams(window.location.search);\n\nconst httpClient = createHttpClient();\nconst store = configureStore({\n  settings: {\n    mode: (urlParams.get('narrow') || '').toLowerCase() === 'true' ? 'narrow' : 'full',\n    home: urlParams.get('home') || '/',\n    pss: urlParams.get('pss') || null\n  }\n}, httpClient);\n\nReactDOM.render(\n  <AppContainer>\n    <HelmetProvider>\n      <Provider store={store}>\n        <ConnectedRouter history={history}>\n          <App />\n        </ConnectedRouter>\n      </Provider>\n    </HelmetProvider>\n  </AppContainer>,\n  document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\nserviceWorker.unregister();\n\n// Start APIs\napiRun(store);","import axios from 'axios';\n\nexport function createHttpClient() {\n    let client = axios.create({\n        baseURL: process.env.REACT_APP_API_ENDPOINT\n    });\n\n    return client;\n}","const PUBLIC_KEY_RE = /^0x[0-9a-f]{130}$/\n\nexport default {\n  isValidPubKey(key) {\n    return PUBLIC_KEY_RE.test(key);\n  },\n\n  validatePubKey(key, account) {\n    if (key === account) {\n      throw new Error('Invalid contact key: this is your own key');\n    }\n\n    if (!PUBLIC_KEY_RE.test(key)) {\n      throw new Error('Invalid contact key: must be an hexadecimal string prefixed with \"0x\"');\n    }\n\n    return true;\n  },\n\n  ensurePrefix(key) {\n    if (key && key.startsWith('0x')) {\n      key = key.substr(2);\n    }\n\n    key = key.length === 128 ? '04' + key : key;\n    return '0x' + key;\n  }\n}","export async function fetchPublicKey(client, query) {\n  const { data } = await client.get(`/api/v0.1/publickeys/lookup?q=${query}`);\n  return data || {};\n}","import { hexValueType } from '@erebos/swarm-browser';\nimport { map, filter } from 'rxjs/operators';\nimport sum from 'hash-sum';\n\nimport keyUtils from './../../base/key';\nimport { createChat } from './../chats/actions';\nimport { getAddress } from './../../base/fn';\nimport * as api from './api';\n\nexport const CONTACTS_RESTORE = 'CONTACTS_RESTORE';\nexport const CONTACT_SUBSCRIBE = 'CONTACT_SUBSCRIBE';\nexport const CONTACT_REQUEST = 'CONTACT_REQUEST';\nexport const CONTACT_RECEIVE = 'CONTACT_RECEIVE';\nexport const CONTACT_MUTATE = 'CONTACT_MUTATE';\nexport const CONTACT_ACCEPT = 'CONTACT_ACCEPT';\nexport const CONTACT_DECLINE = 'CONTACT_DECLINE';\n\nfunction decodePssEvent(data) {\n  return {\n    key: data.key,\n    data: data.msg.toObject(),\n  }\n}\n\nasync function createSubscription(client, publicKey) {\n  const topic = await client.pss.stringToTopic(publicKey);\n  const subscription = await client.pss.createTopicSubscription(topic);\n  return subscription.pipe(\n    map(decodePssEvent),\n    filter((event) => {\n      return (\n        (event.data.type === 'contact_request' &&\n          event.data.payload != null &&\n          event.data.payload.topic != null) ||\n        event.data.type === 'contact_response'\n      )\n    }),\n    map(\n      (event) => ({\n        key: event.key,\n        type: event.data.type,\n        payload: event.data.payload,\n      }),\n    ),\n  )\n}\n\nfunction handler(dispatch, getState) {\n  return async (event) => {\n    const { contacts } = getState();\n    const hash = sum(event.key);\n    const existing = contacts[hash];\n\n    if (\n      event.type === 'contact_request' &&\n      (existing == null || existing.type === 'received_request')\n    ) {\n      // New contact or update existing with new payload\n      const contact = {\n        key: event.key,\n        type: 'received_request',\n        topic: event.payload.topic,\n        username: event.payload.username,\n        address: event.payload.overlay_address,\n      };\n\n      dispatch({ type: CONTACT_RECEIVE, contacts: { [hash]: contact } });\n    } else if (\n      event.type === 'contact_request' &&\n      (existing == null || existing.type === 'added' || existing.type === 'sent_request')\n    ) {\n      // Automatically accept exesting contact\n      const contact = {\n        ...existing,\n        topic: event.payload.topic,\n        username: event.payload.username,\n        address: event.payload.overlay_address,\n      }\n\n      dispatch({ type: CONTACT_MUTATE, contacts: { [hash]: contact } });\n      dispatch(acceptContact(event.key, event.payload.overlay_address));\n    } else if (\n      event.type === 'contact_response' &&\n      event.payload.contact &&\n      existing != null &&\n      (existing.type === 'sent_declined' || existing.type === 'sent_request')\n    ) {\n      // Response from contact, set type to 'added'\n      const contact = {\n        ...existing,\n        type: 'added',\n        username: event.payload.username,\n        address: event.payload.overlay_address,\n      }\n\n      dispatch({ type: CONTACT_MUTATE, contacts: { [hash]: contact } });\n      dispatch(createChat(contact));\n    } else if (\n      event.type === 'contact_response' &&\n      !event.payload.contact &&\n      existing != null &&\n      (existing.type === 'sent_declined' || existing.type === 'sent_request')\n    ) {\n      // Declined contact should be erased from the contact list\n      dispatch({ type: CONTACT_DECLINE, hash });\n    } else {\n      console.error('unhandled event', event);\n      return;\n    }\n  }\n}\n\nexport function subscribe() {\n  return async (dispatch, getState, resolve) => {\n    const { account } = getState();\n    const { client } = resolve();\n    const subscription = await createSubscription(client, account.publicKey);\n    const sub = subscription.subscribe(handler(dispatch, getState));\n    dispatch({ type: CONTACT_SUBSCRIBE, sub });\n  }\n}\n\nexport function restoreContacts(publicKey) {\n  return async (dispatch, getState) => {\n    const { app } = getState();\n    const session = app[publicKey] || {};\n    const contacts = session.contacts || {};\n    dispatch({ type: CONTACTS_RESTORE, contacts });\n    dispatch(subscribe());\n  };\n}\n\nfunction createRandomString() {\n  return Math.random()\n    .toString(36)\n    .slice(2);\n}\n\nexport function inviteContact(query, address) {\n  return async (dispatch, getState, resolve) => {\n    const { httpClient, client } = resolve();\n\n    let publicKey = query;\n    if (!keyUtils.isValidPubKey(publicKey)) {\n      const data = await api.fetchPublicKey(httpClient, query);\n      if (!data || !data.publicKey) {\n        throw new Error('Public key not found');\n      }\n\n      publicKey = keyUtils.ensurePrefix(data.publicKey);\n    }\n\n    const { account, contacts, settings } = getState();\n    const publicKeyHex = hexValueType(publicKey);\n    const hash = sum(publicKeyHex);\n\n    keyUtils.validatePubKey(publicKeyHex, account.publicKey);\n\n    const contact = contacts[hash];\n    if (contact && contact.type === 'received_request') {\n      dispatch(acceptContact(publicKeyHex, address));\n      return;\n    }\n\n    if (contact && contact.type !== 'sent_request') {\n      throw new Error('The contact already present in your list of contacts');\n    }\n\n    const [contactTopic, sharedTopic] = await Promise.all([\n      client.pss.stringToTopic(publicKeyHex),\n      client.pss.stringToTopic(createRandomString()),\n    ]);\n\n    await client.pss.setPeerPublicKey(publicKeyHex, contactTopic, address || '0x');\n    const pssMessage = {\n      type: 'contact_request',\n      payload: {\n        username: account.username,\n        message: null,\n        topic: sharedTopic,\n        overlay_address: getAddress(account.overlayAddress, settings.revealAddress),\n      },\n      utc_timestamp: Date.now()\n    };\n    await client.pss.sendAsym(publicKeyHex, contactTopic, pssMessage);\n\n    dispatch({\n      type: CONTACT_REQUEST,\n      contacts: {\n        [hash]: {\n          key: publicKeyHex,\n          topic: sharedTopic,\n          type: 'sent_request'\n        }\n      }\n    });\n  };\n}\n\nasync function sendResponse(client, getState, publicKey, address, accept) {\n  const topic = await client.pss.stringToTopic(publicKey);\n  let payload = { contact: accept };\n\n  if (accept) {\n    const { account, settings } = getState();\n    payload = {\n      ...payload,\n      username: account.username,\n      overlay_address: getAddress(account.overlayAddress, settings.revealAddress),\n    };\n\n    await client.pss.setPeerPublicKey(publicKey, topic, address || '0x');\n  }\n\n  const message = {\n    type: 'contact_response',\n    payload,\n    utc_timestamp: Date.now()\n  };\n  await client.pss.sendAsym(publicKey, topic, message);\n}\n\nexport function acceptContact(publicKey, address) {\n  return async (dispatch, getState, resolve) => {\n    const { contacts } = getState();\n    const { client } = resolve();\n    await sendResponse(client, getState, publicKey, address, true);\n\n    const hash = sum(publicKey);\n    const contact = {\n      ...contacts[hash],\n      type: 'added'\n    };\n\n    dispatch({ type: CONTACT_ACCEPT, contacts: { [hash]: contact } });\n    dispatch(createChat(contact));\n  }\n}\n\nexport function declineContact(publicKey, address) {\n  return async (dispatch, getState, resolve) => {\n    const { client } = resolve();\n    await sendResponse(client, getState, publicKey, address, false);\n\n    const hash = sum(publicKey);\n    dispatch({ type: CONTACT_DECLINE, hash });\n  }\n}","import { map, filter } from 'rxjs/operators';\nimport sum from 'hash-sum';\nimport FileSaver from 'file-saver';\n\nimport { readFile } from './../../base/fn';\n\nexport const CHATS_RESTORE = 'CHATS_RESTORE';\nexport const CHAT_CREATE = 'CHAT_CREATE';\nexport const CHAT_SUBSCRIBE = 'CHAT_SUBSCRIBE';\nexport const CHAT_SEND_MESSAGE = 'CHAT_SEND_MESSAGE';\nexport const CHAT_RECEIVE_MESSAGE = 'CHAT_RECEIVE_MESSAGE';\n\nfunction decodePssEvent(data) {\n  return {\n    key: data.key,\n    data: data.msg.toObject(),\n  }\n}\n\nfunction getChat(key, chats) {\n  const chat = chats[key];\n  if (!chat) {\n    throw new Error('Chat is not found');\n  }\n  return chat;\n}\n\nasync function createSubscription(client, chat) {\n  const [sub] = await Promise.all([\n    client.pss.createTopicSubscription(chat.topic),\n    client.pss.setPeerPublicKey(chat.key, chat.topic, chat.address),\n  ])\n  return sub.pipe(\n    map(decodePssEvent),\n    filter((event) => {\n      return event.data.type === 'chat_message' &&\n        event.data.payload != null\n    }),\n    map(\n      (event) => ({\n        key: event.key,\n        type: event.data.type,\n        utc_timestamp: event.data.utc_timestamp,\n        payload: event.data.payload,\n      }),\n    ),\n  )\n}\n\nfunction handler(dispatch, getState) {\n  return async (event) => {\n    const { chats } = getState();\n    const hash = sum(event.key);\n    const chat = getChat(hash, chats);\n\n    const message = {\n      sender: hash,\n      isRead: false,\n      text: event.payload.text,\n      timestamp: event.utc_timestamp,\n    }\n\n    const existing = chat.messages[sum(message)];\n    if (existing) {\n      return;\n    }\n\n    dispatch({ type: CHAT_RECEIVE_MESSAGE, hash, message });\n  }\n}\n\nfunction subscribe(chat) {\n  return async (dispatch, getState, resolve) => {\n    const { client } = resolve();\n    const subscription = await createSubscription(client, chat);\n    const sub = subscription.subscribe(handler(dispatch, getState));\n    dispatch({ type: CHAT_SUBSCRIBE, sub });\n  }\n}\n\nfunction subscribeAll(dispatch, chats) {\n  Object.values(chats).map(chat => dispatch(subscribe(chat)));\n}\n\nexport function restoreChats(publicKey) {\n  return async (dispatch, getState) => {\n    const { app } = getState();\n    const session = app[publicKey] || {};\n    const chats = session.chats || {};\n    dispatch({ type: CHATS_RESTORE, chats });\n    subscribeAll(dispatch, chats);\n  };\n}\n\nexport function createChat(contact) {\n  return async (dispatch, getState) => {\n    const { account } = getState();\n    const hash = sum(contact.key);\n    const chat = {\n      key: contact.key,\n      topic: contact.topic,\n      address: contact.address,\n      participants: {\n        [hash]: contact.key,\n        [sum(account.publicKey)]: account.publicKey,\n      },\n      messages: {}\n    }\n\n    dispatch({ type: CHAT_CREATE, chats: { [hash]: chat } });\n    dispatch(subscribe(chat));\n  };\n}\n\nasync function send(dispatch, client, chat, publicKey, text) {\n  const pssMessage = {\n    type: 'chat_message',\n    payload: { text },\n    utc_timestamp: Date.now()\n  };\n  await client.pss.sendAsym(chat.key, chat.topic, pssMessage);\n\n  const message = {\n    sender: sum(publicKey),\n    isRead: true,\n    timestamp: Date.now(),\n    text\n  }\n\n  dispatch({ type: CHAT_SEND_MESSAGE, hash: sum(chat.key), message });\n}\n\nexport function sendMessage(key, text) {\n  return async (dispatch, getState, resolve) => {\n    const { account, chats } = getState();\n    const chat = getChat(key, chats);\n    const { client } = resolve();\n    send(dispatch, client, chat, account.publicKey, text);\n  };\n}\n\nexport function sendFile(key, file) {\n  return async (dispatch, getState, resolve) => {\n    const { account, chats } = getState();\n    const chat = getChat(key, chats);\n\n    const { client } = resolve();\n    const { bzz } = client;\n    const readEvent = await readFile(file);\n    const buffer = readEvent.currentTarget.result\n    const hash = await bzz.uploadFile(buffer, { contentType: file.type });\n\n    const text = `bzz:/${hash}`;\n    send(dispatch, client, chat, account.publicKey, text);\n  };\n}\n\nexport function download(hash) {\n  return async (_, __, resolve) => {\n    const { client } = resolve();\n    const { bzz } = client;\n    const file = await bzz.download(hash);\n    await FileSaver.saveAs(await file.blob());\n  }\n}\n","export const groupBy = (xs, key) => {\n  return xs.reduce(function (rv, x) {\n    (rv[x[key]] = rv[x[key]] || []).push(x);\n    return rv;\n  }, {});\n};\n\nexport const readFile = (file) => {\n  return new Promise((resolve, _) => {\n    const fr = new FileReader();\n    fr.onload = resolve;\n    fr.readAsArrayBuffer(file);\n  });\n};\n\nexport const getAddress = (address = '', reveal = 0) => {\n  return address.substring(0, 2 + reveal * 2) || '0x';\n}"],"sourceRoot":""}